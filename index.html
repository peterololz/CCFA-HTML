<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CCFA 200 Test – 155 Questions</title>
  <style>
    :root{
      --bg:#0b0f14;--card:#111827;--muted:#9aa4b2;--text:#e5e7eb;--accent:#60a5fa;
      --good:#22c55e;--bad:#ef4444;--border:rgba(255,255,255,.08);
      --shadow: 0 12px 40px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1000px 600px at 20% 0%, rgba(96,165,250,.18), transparent 55%),
                  radial-gradient(900px 500px at 85% 15%, rgba(34,197,94,.12), transparent 60%),
                  var(--bg);
      color:var(--text);
      padding: 28px 16px 56px;
    }
    .wrap{max-width: 980px; margin:0 auto;}
    .header{display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap; margin-bottom: 16px;}
    .title{margin:0; font-size: 22px; font-weight: 800; letter-spacing: .2px;}
    .sub{margin:6px 0 0; color: var(--muted); font-size: 14px; line-height: 1.45; max-width: 720px;}
    .metaRow{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-end;}
    .pill{display:inline-flex; align-items:center; gap:8px; border:1px solid var(--border);
      background: rgba(255,255,255,.03); padding: 8px 10px; border-radius: 999px; font-size: 13px; white-space: nowrap;}
    .pill b{font-weight:800}
    .card{border: 1px solid var(--border); background: rgba(17,24,39,.78); backdrop-filter: blur(8px);
      border-radius: 18px; box-shadow: var(--shadow); padding: 18px; overflow:hidden;}
    .progressWrap{margin-top: 14px;}
    .progressTop{display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; margin-bottom: 8px;}
    .progressText{color: var(--muted); font-size: 13px;}
    .bar{width:100%; height: 10px; border-radius: 999px; background: rgba(255,255,255,.06); overflow:hidden; border: 1px solid var(--border);}
    .bar > div{height:100%; width:0%; background: linear-gradient(90deg, rgba(96,165,250,.95), rgba(34,197,94,.95)); transition: width .28s ease;}
    .qNum{font-size: 13px; color: var(--muted); letter-spacing:.2px; margin:0;}
    .qTitle{margin: 6px 0 0; font-size: 18px; font-weight: 800; line-height: 1.35;}
    .divider{height:1px; background: rgba(255,255,255,.08); margin: 14px 0;}
    .options{display:grid; gap: 10px; margin-top: 10px;}
    .opt{display:flex; gap: 10px; align-items:flex-start; border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03); padding: 10px 12px; border-radius: 14px; cursor:pointer;
      transition: transform .08s ease, border-color .12s ease, background .12s ease;}
    .opt:hover{transform: translateY(-1px); border-color: rgba(96,165,250,.35); background: rgba(96,165,250,.06);}
    .opt input{margin-top: 3px;}
    .opt .letter{font-weight: 900; width: 22px; color: rgba(229,231,235,.9);}
    .opt .text{color: rgba(229,231,235,.92); line-height: 1.35;}
    .actions{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top: 14px;}
    button{appearance:none; border:1px solid rgba(255,255,255,.14); background: rgba(255,255,255,.04); color: var(--text);
      padding: 10px 14px; border-radius: 12px; font-weight: 800; cursor:pointer;
      transition: transform .08s ease, border-color .12s ease, background .12s ease;}
    button:hover{transform: translateY(-1px); border-color: rgba(96,165,250,.45); background: rgba(96,165,250,.10);}
    button:disabled{opacity: .55; cursor:not-allowed; transform:none;}
    .primary{border-color: rgba(96,165,250,.55); background: rgba(96,165,250,.14);}
    .ghost{background: transparent;}
    .feedback{margin-top: 14px; padding: 12px 14px; border-radius: 14px; border: 1px solid rgba(255,255,255,.12); display:none;}
    .feedback.good{border-color: rgba(34,197,94,.45); background: rgba(34,197,94,.10);}
    .feedback.bad{border-color: rgba(239,68,68,.45); background: rgba(239,68,68,.10);}
    .feedback .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-bottom: 6px;}
    .badge{display:inline-flex; align-items:center; gap:8px; padding: 6px 10px; border-radius: 999px; font-size: 12px;
      border: 1px solid rgba(255,255,255,.14); background: rgba(255,255,255,.04); font-weight: 900;}
    .badge.good{border-color: rgba(34,197,94,.45); background: rgba(34,197,94,.12);}
    .badge.bad{border-color: rgba(239,68,68,.45); background: rgba(239,68,68,.12);}
    .muted{color: var(--muted); font-size: 13px;}
    .explain{margin: 8px 0 0; color: rgba(229,231,235,.92); line-height: 1.45;}
    .hint{margin-top: 12px; color: var(--muted); font-size: 13px;}
    .kbd{border:1px solid rgba(255,255,255,.14); background: rgba(255,255,255,.04); padding: 1px 8px; border-radius: 8px; font-weight: 900;}
  
    .savewrap{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-left:auto}
    .autosave{display:flex;align-items:center;gap:8px;font-size:13px;opacity:.9}
    .autosave input{transform:translateY(1px)}
    .ghost{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:#e9eef6;padding:10px 14px;border-radius:14px;font-weight:700;cursor:pointer}
    .ghost:hover{background:rgba(255,255,255,.09)}
    .ghost.danger{border-color:rgba(255,80,80,.28);color:#ffd7d7}
    .ghost.danger:hover{background:rgba(255,80,80,.10)}
    .savestatus{font-size:12px;opacity:.75;min-width:120px}


    /* Mistakes modal */
    .modal{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:flex; align-items:center; justify-content:center; padding:18px; z-index:9999;}
    .modal-card{ width:min(980px, 96vw); max-height:88vh; overflow:hidden; background:#0f172a; border:1px solid rgba(255,255,255,.12); border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.35); }
    .modal-head{ display:flex; align-items:flex-start; justify-content:space-between; gap:12px; padding:14px 16px; border-bottom:1px solid rgba(255,255,255,.10); }
    .modal-title{ font-weight:700; font-size:18px; }
    .modal-sub{ opacity:.8; font-size:12px; margin-top:2px; }
    .modal-actions{ display:flex; flex-wrap:wrap; gap:8px; padding:12px 16px; border-bottom:1px solid rgba(255,255,255,.10); }
    .modal-body{ padding:14px 16px; overflow:auto; max-height:calc(88vh - 120px); }
    .mistakes-list{ display:grid; gap:12px; }
    .mistake-card{ border:1px solid rgba(255,255,255,.10); border-radius:14px; padding:12px 12px; background:rgba(255,255,255,.03); }
    .mistake-top{ display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .mistake-q{ font-weight:650; }
    .mistake-meta{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .pill{ display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.14); font-size:12px; opacity:.95; }
    .pill.bad{ border-color: rgba(239,68,68,.45); }
    .pill.good{ border-color: rgba(34,197,94,.45); }
    .mistake-grid{ display:grid; grid-template-columns:1fr; gap:8px; margin-top:10px; }
    @media (min-width: 900px){ .mistake-grid{ grid-template-columns:1fr 1fr; } }
    .mistake-box{ border:1px dashed rgba(255,255,255,.14); border-radius:12px; padding:10px; }
    .mistake-box b{ font-weight:700; }
    .mistake-actions{ margin-top:10px; display:flex; gap:8px; flex-wrap:wrap; }
    .tiny{ font-size:12px; opacity:.85; }

    /* Options review inside mistakes modal */
    .opt-review{ display:grid; gap:6px; margin-top:10px; }
    .opt-item{ display:flex; gap:8px; align-items:flex-start; padding:8px 10px; border-radius:12px;
      border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.02); }
    .opt-letter{ min-width:22px; font-weight:800; }
    .opt-item.correct{ border-color: rgba(70,255,160,.28); background: rgba(70,255,160,.06); }
    .opt-item.selected-wrong{ border-color: rgba(255,80,80,.28); background: rgba(255,80,80,.07); }
    .opt-item.selected-correct{ border-color: rgba(70,255,160,.35); background: rgba(70,255,160,.10); }
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div>
        <h1 class="title">CCFA 200 Test – 155 Questions</h1>
      <div id="countWarn" class="sub" style="margin-top:6px; color:#ffb4b4; display:none;"></div>
        <p class="sub">One question at a time. Question order and answer order are randomized on load. Submit each question for instant feedback + explanation.</p>
      </div>
      <div class="metaRow">
        <div class="pill">Answered: <b id="answered">0</b>/<b id="total">0</b></div>
        <div class="pill">Score: <b id="score">0</b></div>
        <div class="pill">Current: <b id="currentIdx">1</b>/<b id="total2">0</b></div>
      </div>
    </div>

    <div class="card">
      <div class="progressWrap">
        <div class="progressTop">
          <div class="progressText" id="progressText">Progress: 0%</div>
          <div class="progressText muted" id="progressDetail">0 answered • 0 correct</div>
        </div>
        <div class="bar"><div id="barFill"></div></div>
      </div>

      <div class="divider"></div>

      <div id="questionArea"></div>

      <div class="divider"></div>

      <div class="actions">
        <button class="ghost" id="prevBtn" onclick="prevQ()">← Previous</button>
        <button class="ghost" id="nextBtn" onclick="nextQ()">Next →</button>
        <button class="primary" id="submitBtn" onclick="submitAnswer()">Submit Answer</button>
        <button id="resetBtn" onclick="resetQuiz()">Reset (reshuffle)</button>
        <button class="ghost" id="reviewMistakesBtn" type="button">Ver falladas</button>
        <button class="ghost" id="practiceMistakesBtn" type="button" title="Navega solo por las preguntas falladas">Repasar falladas</button>

        <div class="savewrap">
          <label class="autosave">
            <input type="checkbox" id="autoSaveToggle" checked>
            Auto-guardar
          </label>
          <button class="ghost" type="button" id="saveBtn" onclick="saveProgress(true)">Guardar</button>
          <button class="ghost" type="button" id="loadBtn" onclick="loadProgress(true)">Cargar</button>
          <button class="ghost danger" type="button" id="clearBtn" onclick="clearProgress()">Borrar</button>
          <span class="savestatus" id="saveStatus" aria-live="polite"></span>
        </div>

      </div>

      <div class="hint">
        Shortcuts: <span class="kbd">←</span>/<span class="kbd">→</span> to navigate • <span class="kbd">Enter</span> to submit
      </div>
    </div>
  </div>

<script>
const RAW_QUESTIONS = [
  {
    "id": "q001",
    "prompt": "What is the function of a single asterisk (*) in an ML exclusion pattern?",
    "options": [
      {
        "id": "q001_a",
        "text": "The single asterisk will match any number of characters, including none. It does include separator characters, such as \\ or /, which separate portions of a file path"
      },
      {
        "id": "q001_b",
        "text": "The single asterisk will match any number of characters, including none. It does not include separator characters, such as \\ or /, which separate portions of a file path"
      },
      {
        "id": "q001_c",
        "text": "The single asterisk is the insertion point for the variable list that follows the path"
      },
      {
        "id": "q001_d",
        "text": "The single asterisk is only used to start an expression, and it represents the drive letter"
      }
    ],
    "correctOptionId": "q001_b",
    "explanation": ""
  },
  {
    "id": "q002",
    "prompt": "You have determined that you have numerous Machine Learning detections in your environment that are false positives. They are caused by a single binary that was custom written by a vendor for you and that binary is running on many endpoints. What is the best way to prevent these in the future?",
    "options": [
      {
        "id": "q002_a",
        "text": "Contact support and request that they modify the Machine Learning settings to no longer include this detection"
      },
      {
        "id": "q002_b",
        "text": "Using IOC Management, add the hash of the binary in question and set the action to \"Allow\""
      },
      {
        "id": "q002_c",
        "text": "Using IOC Management, add the hash of the binary in question and set the action to \"Block, hide detection\""
      },
      {
        "id": "q002_d",
        "text": "Using IOC Management, add the hash of the binary in question and set the action to \"No Action\""
      }
    ],
    "correctOptionId": "q002_b",
    "explanation": ""
  },
  {
    "id": "q003",
    "prompt": "What is the purpose of a containment policy?",
    "options": [
      {
        "id": "q003_a",
        "text": "To define which Falcon analysts can contain endpoints"
      },
      {
        "id": "q003_b",
        "text": "To define the duration of Network Containment"
      },
      {
        "id": "q003_c",
        "text": "To define the trigger under which a machine is put in Network Containment (e.g. a critical detection)"
      },
      {
        "id": "q003_d",
        "text": "To define allowed IP addresses over which your hosts will communicate when contained"
      }
    ],
    "correctOptionId": "q003_d",
    "explanation": ""
  },
  {
    "id": "q004",
    "prompt": "An administrator creating an exclusion is limited to applying a rule to how many groups of hosts?",
    "options": [
      {
        "id": "q004_a",
        "text": "File exclusions are not aligned to groups or hosts"
      },
      {
        "id": "q004_b",
        "text": "There is a limit of three groups of hosts applied to any exclusion"
      },
      {
        "id": "q004_c",
        "text": "There is no limit and exclusions can be applied to any or all groups"
      },
      {
        "id": "q004_d",
        "text": "Each exclusion can be aligned to only one group of hosts"
      }
    ],
    "correctOptionId": "q004_c",
    "explanation": ""
  },
  {
    "id": "q005",
    "prompt": "Even though you are a Falcon Administrator, you discover you are unable to use the \"Connect to Host\" feature to gather additional information which is only available on the host. Which role do you need added to your user account to have this capability?",
    "options": [
      {
        "id": "q005_a",
        "text": "Real Time Responder"
      },
      {
        "id": "q005_b",
        "text": "Endpoint Manager"
      },
      {
        "id": "q005_c",
        "text": "Falcon Investigator"
      },
      {
        "id": "q005_d",
        "text": "Remediation Manager"
      }
    ],
    "correctOptionId": "q005_a",
    "explanation": ""
  },
  {
    "id": "q006",
    "prompt": "What must an admin do to reset a user's password?",
    "options": [
      {
        "id": "q006_a",
        "text": "From User Management, open the account details for the affected user and select \"Generate New Password\""
      },
      {
        "id": "q006_b",
        "text": "From User Management, select \"Reset Password\" from the three dot menu for the affected user account"
      },
      {
        "id": "q006_c",
        "text": "From User Management, select \"Update Account\" and manually create a new password for the affected user account"
      },
      {
        "id": "q006_d",
        "text": "From User Management, the administrator must rebuild the account as the certificate for user specific private/public key generation is no longer valid"
      }
    ],
    "correctOptionId": "q006_b",
    "explanation": ""
  },
  {
    "id": "q007",
    "prompt": "When creating new IOCs in IOC management, which of the following fields must be configured?",
    "options": [
      {
        "id": "q007_a",
        "text": "Hash, Description, Filename"
      },
      {
        "id": "q007_b",
        "text": "Hash, Action and Expiry Date"
      },
      {
        "id": "q007_c",
        "text": "Filename, Severity and Expiry Date"
      },
      {
        "id": "q007_d",
        "text": "Hash, Platform and Action"
      }
    ],
    "correctOptionId": "q007_d",
    "explanation": ""
  },
  {
    "id": "q008",
    "prompt": "Your organization has a set of servers that are not allowed to be accessed remotely, including via Real Time Response (RTR). You already have these servers in their own Falcon host group. What is the next step to disable RTR only on these hosts?",
    "options": [
      {
        "id": "q008_a",
        "text": "Edit the Default Response Policy, toggle the \"Real Time Response\" switch off and assign the policy to the host group"
      },
      {
        "id": "q008_b",
        "text": "Edit the Default Response Policy and add the host group to the exceptions list under \"Real Time Functionality\""
      },
      {
        "id": "q008_c",
        "text": "Create a new Response Policy, toggle the \"Real Time Response\" switch off and assign the policy to the host group"
      },
      {
        "id": "q008_d",
        "text": "Create a new Response Policy and add the host name to the exceptions list under \"Real Time Functionality\""
      }
    ],
    "correctOptionId": "q008_c",
    "explanation": ""
  },
  {
    "id": "q009",
    "prompt": "Your CISO has decided all Falcon Analysts should also have the ability to view files and file contents locally on compromised hosts, but without the ability to take them off the host. What is the most appropriate role that can be added to fullfil this requirement?",
    "options": [
      {
        "id": "q009_a",
        "text": "Remediation Manager"
      },
      {
        "id": "q009_b",
        "text": "Real Time Responder – Read Only Analyst"
      },
      {
        "id": "q009_c",
        "text": "Falcon Analyst – Read Only"
      },
      {
        "id": "q009_d",
        "text": "Real Time Responder – Active Responder"
      }
    ],
    "correctOptionId": "q009_b",
    "explanation": ""
  },
  {
    "id": "q010",
    "prompt": "One of your development teams is working on code for a new enterprise application but Falcon continually flags the execution as a detection during testing. All development work is required to be stored on a file share in a folder called \"devcode.\" What setting can you use to reduce false positives on this file path?",
    "options": [
      {
        "id": "q010_a",
        "text": "USB Device Policy"
      },
      {
        "id": "q010_b",
        "text": "Firewall Rule Group"
      },
      {
        "id": "q010_c",
        "text": "Containment Policy"
      },
      {
        "id": "q010_d",
        "text": "Machine Learning Exclusions"
      }
    ],
    "correctOptionId": "q010_d",
    "explanation": ""
  },
  {
    "id": "q011",
    "prompt": "How do you disable all detections for a host?",
    "options": [
      {
        "id": "q011_a",
        "text": "Create an exclusion rule and apply it to the machine or group of machines"
      },
      {
        "id": "q011_b",
        "text": "Contact support and provide them with the Agent ID (AID) for the machine and they will put it on the Disabled Hosts list in your Customer ID (CID)"
      },
      {
        "id": "q011_c",
        "text": "You cannot disable all detections on individual hosts as it would put them at risk"
      },
      {
        "id": "q011_d",
        "text": "In Host Management, select the host and then choose the option to Disable Detections"
      }
    ],
    "correctOptionId": "q011_d",
    "explanation": ""
  },
  {
    "id": "q012",
    "prompt": "To enhance your security, you want to detect and block based on a list of domains and IP addresses. How can you use IOC management to help this objective?",
    "options": [
      {
        "id": "q012_a",
        "text": "Blocking of Domains and IP addresses is not a function of IOC management. A Custom IOA Rule should be used instead"
      },
      {
        "id": "q012_b",
        "text": "Using IOC management, import the list of hashes and IP addresses and set the action to Detect Only"
      },
      {
        "id": "q012_c",
        "text": "Using IOC management, import the list of hashes and IP addresses and set the action to Prevent/Block"
      },
      {
        "id": "q012_d",
        "text": "Using IOC management, import the list of hashes and IP addresses and set the action to No Action"
      }
    ],
    "correctOptionId": "q012_a",
    "explanation": ""
  },
  {
    "id": "q013",
    "prompt": "Which role is required to manage groups and policies in Falcon?",
    "options": [
      {
        "id": "q013_a",
        "text": "Falcon Host Analyst"
      },
      {
        "id": "q013_b",
        "text": "Falcon Host Administrator"
      },
      {
        "id": "q013_c",
        "text": "Prevention Hashes Manager"
      },
      {
        "id": "q013_d",
        "text": "Falcon Host Security Lead"
      }
    ],
    "correctOptionId": "q013_b",
    "explanation": ""
  },
  {
    "id": "q014",
    "prompt": "Which of the following can a Falcon Administrator edit in an existing user's profile?",
    "options": [
      {
        "id": "q014_a",
        "text": "First or Last name"
      },
      {
        "id": "q014_b",
        "text": "Phone number"
      },
      {
        "id": "q014_c",
        "text": "Email address"
      },
      {
        "id": "q014_d",
        "text": "Working groups"
      }
    ],
    "correctOptionId": "q014_a",
    "explanation": ""
  },
  {
    "id": "q015",
    "prompt": "You want the Falcon Cloud to push out sensor version changes but you also want to manually control when the sensor version is upgraded or downgraded. In the Sensor Update policy, which is the best Sensor version option to achieve these requirements?",
    "options": [
      {
        "id": "q015_a",
        "text": "Specific sensor version number"
      },
      {
        "id": "q015_b",
        "text": "Auto - TEST-QA"
      },
      {
        "id": "q015_c",
        "text": "Sensor version updates off"
      },
      {
        "id": "q015_d",
        "text": "Auto - N-1"
      }
    ],
    "correctOptionId": "q015_a",
    "explanation": ""
  },
  {
    "id": "q016",
    "prompt": "What is the goal of a Network Containment Policy?",
    "options": [
      {
        "id": "q016_a",
        "text": "Increase the aggressiveness of the assigned prevention policy"
      },
      {
        "id": "q016_b",
        "text": "Limit the impact of a compromised host on the network"
      },
      {
        "id": "q016_c",
        "text": "Gain more visibility into network activities"
      },
      {
        "id": "q016_d",
        "text": "Partition a network for privacy"
      }
    ],
    "correctOptionId": "q016_b",
    "explanation": ""
  },
  {
    "id": "q017",
    "prompt": "Which of the following applies to Custom Blocking Prevention Policy settings?",
    "options": [
      {
        "id": "q017_a",
        "text": "Hashes must be entered on the Prevention Hashes page before they can be blocked via this policy"
      },
      {
        "id": "q017_b",
        "text": "Blocklisting applies to hashes, IP addresses, and domains"
      },
      {
        "id": "q017_c",
        "text": "Executions blocked via hash blocklist may have partially executed prior to hash calculation process remediation may be necessary"
      },
      {
        "id": "q017_d",
        "text": "You can only blocklist hashes via the API"
      }
    ],
    "correctOptionId": "q017_a",
    "explanation": ""
  },
  {
    "id": "q018",
    "prompt": "How many \"Auto\" sensor version update options are available for Windows Sensor Update Policies?",
    "options": [
      {
        "id": "q018_a",
        "text": "1"
      },
      {
        "id": "q018_b",
        "text": "2"
      },
      {
        "id": "q018_c",
        "text": "0"
      },
      {
        "id": "q018_d",
        "text": "3"
      }
    ],
    "correctOptionId": "q018_d",
    "explanation": ""
  },
  {
    "id": "q019",
    "prompt": "The alignment of a particular prevention policy to one or more host groups can be completed in which of the following locations within Falcon?",
    "options": [
      {
        "id": "q019_a",
        "text": "Policy alignment is configured in the \"Host Management\" section in the Hosts application"
      },
      {
        "id": "q019_b",
        "text": "Policy alignment is configured only once during the initial creation of the policy in the \"Create New Policy\" pop-up window"
      },
      {
        "id": "q019_c",
        "text": "Policy alignment is configured in the General Settings section under the Configuration menu"
      },
      {
        "id": "q019_d",
        "text": "Policy alignment is configured in each policy in the \"Assigned Host Groups\" tab"
      }
    ],
    "correctOptionId": "q019_d",
    "explanation": ""
  },
  {
    "id": "q020",
    "prompt": "How long are detection events kept in Falcon?",
    "options": [
      {
        "id": "q020_a",
        "text": "Detection events are kept for 90 days"
      },
      {
        "id": "q020_b",
        "text": "Detections events are kept for your subscribed data retention period"
      },
      {
        "id": "q020_c",
        "text": "Detection events are kept for 7 days"
      },
      {
        "id": "q020_d",
        "text": "Detection events are kept for 30 days"
      }
    ],
    "correctOptionId": "q020_b",
    "explanation": ""
  },
  {
    "id": "q021",
    "prompt": "What information is provided in Logan Activities under Visibility Reports?",
    "options": [
      {
        "id": "q021_a",
        "text": "A list of all logons for all users"
      },
      {
        "id": "q021_b",
        "text": "A list of last endpoints that a user logged in to"
      },
      {
        "id": "q021_c",
        "text": "A list of users who are remotely logged on to devices based on local IP and local port"
      },
      {
        "id": "q021_d",
        "text": "A list of unique users who are remotely logged on to devices based on the country"
      }
    ],
    "correctOptionId": "q021_b",
    "explanation": ""
  },
  {
    "id": "q022",
    "prompt": "What can the Quarantine Manager role do?",
    "options": [
      {
        "id": "q022_a",
        "text": "Manage and change prevention settings"
      },
      {
        "id": "q022_b",
        "text": "Manage quarantined files to release and download"
      },
      {
        "id": "q022_c",
        "text": "Manage detection settings"
      },
      {
        "id": "q022_d",
        "text": "Manage roles and users"
      }
    ],
    "correctOptionId": "q022_b",
    "explanation": ""
  },
  {
    "id": "q023",
    "prompt": "What command should be run to verify if a Windows sensor is running?",
    "options": [
      {
        "id": "q023_a",
        "text": "regedit myfile.reg"
      },
      {
        "id": "q023_b",
        "text": "sc query csagent"
      },
      {
        "id": "q023_c",
        "text": "netstat -f"
      },
      {
        "id": "q023_d",
        "text": "ps -ef | grep falcon"
      }
    ],
    "correctOptionId": "q023_b",
    "explanation": ""
  },
  {
    "id": "q024",
    "prompt": "When configuring a specific prevention policy, the admin can align the policy to two different types of groups, Host Groups and which other?",
    "options": [
      {
        "id": "q024_a",
        "text": "Custom IOA Rule Groups"
      },
      {
        "id": "q024_b",
        "text": "Custom IOC Groups"
      },
      {
        "id": "q024_c",
        "text": "Enterprise Groups"
      },
      {
        "id": "q024_d",
        "text": "Operating System Groups"
      }
    ],
    "correctOptionId": "q024_a",
    "explanation": ""
  },
  {
    "id": "q025",
    "prompt": "Which role allows a user to connect to hosts using Real-Time Response?",
    "options": [
      {
        "id": "q025_a",
        "text": "Endpoint Manager"
      },
      {
        "id": "q025_b",
        "text": "Falcon Administrator"
      },
      {
        "id": "q025_c",
        "text": "Real Time Responder – Active Responder"
      },
      {
        "id": "q025_d",
        "text": "Prevention Hashes Manager"
      }
    ],
    "correctOptionId": "q025_c",
    "explanation": ""
  },
  {
    "id": "q026",
    "prompt": "You are attempting to install the Falcon sensor on a host with a slow Internet connection and the installation fails after 20 minutes. Which of the following parameters can be used to override the 20 minute default provisioning window?",
    "options": [
      {
        "id": "q026_a",
        "text": "ExtendedWindow=1"
      },
      {
        "id": "q026_b",
        "text": "Timeout=0"
      },
      {
        "id": "q026_c",
        "text": "ProvNoWait=1"
      },
      {
        "id": "q026_d",
        "text": "Timeout=30"
      }
    ],
    "correctOptionId": "q026_c",
    "explanation": ""
  },
  {
    "id": "q027",
    "prompt": "How can you find a list of hosts that have not communicated with the CrowdStrike Cloud in the last 30 days?",
    "options": [
      {
        "id": "q027_a",
        "text": "Under Dashboards and reports, choose the Sensor Report. Set the \"Last Seen\" dropdown to 30 days and reference the Inactive Sensors widget"
      },
      {
        "id": "q027_b",
        "text": "Under Host setup and management, choose the Host Management page. Set the group filter to \"Inactive Sensors\""
      },
      {
        "id": "q027_c",
        "text": "Under Host setup and management > Managed endpoints > Inactive Sensors. Change the time range to 30 days"
      },
      {
        "id": "q027_d",
        "text": "Under Host setup and management, choose the Disabled Sensors Report. Change the time range to 30 days"
      }
    ],
    "correctOptionId": "q027_c",
    "explanation": ""
  },
  {
    "id": "q028",
    "prompt": "In order to quarantine files on the host, what prevention policy settings must be enabled?",
    "options": [
      {
        "id": "q028_a",
        "text": "Malware Protection and Custom Execution Blocking must be enabled"
      },
      {
        "id": "q028_b",
        "text": "Next-Gen Antivirus Prevention sliders and \"Quarantine & Security Center Registration\" must be enabled"
      },
      {
        "id": "q028_c",
        "text": "Malware Protection and Windows Anti-Malware Execution Blocking must be enabled"
      },
      {
        "id": "q028_d",
        "text": "Behavior-Based Threat Prevention sliders and Advanced Remediation Actions must be enabled"
      }
    ],
    "correctOptionId": "q028_b",
    "explanation": ""
  },
  {
    "id": "q029",
    "prompt": "Why is it critical to have separate sensor update policies for Windows/Mac/*nix?",
    "options": [
      {
        "id": "q029_a",
        "text": "There may be special considerations for each OS"
      },
      {
        "id": "q029_b",
        "text": "To assist with testing and tracking sensor rollouts"
      },
      {
        "id": "q029_c",
        "text": "The network protocols are different for each host OS"
      },
      {
        "id": "q029_d",
        "text": "It is an auditing requirement"
      }
    ],
    "correctOptionId": "q029_a",
    "explanation": ""
  },
  {
    "id": "q030",
    "prompt": "How do you assign a policy to a specific group of hosts?",
    "options": [
      {
        "id": "q030_a",
        "text": "Create a group containing the desired hosts using \"Static Assignment.\" Go to the Assigned Host Groups tab of the desired policy and click \"Add groups to policy.\" Select the desired Group(s)."
      },
      {
        "id": "q030_b",
        "text": "Assign a tag to the desired hosts in Host Management. Create a group with an assignment rule based on that tag. Go to the Assignment tab of the desired policy and click \"Add Groups to Policy.\" Select the desired Group(s)."
      },
      {
        "id": "q030_c",
        "text": "Create a group containing the desired hosts using \"Dynamic Assignment.\" Go to the Assigned Host Groups tab of the desired policy and select criteria such as OU, OS, Hostname pattern, etc."
      },
      {
        "id": "q030_d",
        "text": "On the Assignment tab of the desired policy, select \"Static\" assignment. From the next window, select the desired hosts (using fitters if needed) and click Add."
      }
    ],
    "correctOptionId": "q030_b",
    "explanation": ""
  },
  {
    "id": "q031",
    "prompt": "You want to create a detection-only policy. How do you set this up in your policy's settings?",
    "options": [
      {
        "id": "q031_a",
        "text": "Enable the detection sliders and disable the prevention sliders. Then ensure that Next Gen Antivirus is enabled so it will disable Windows Defender."
      },
      {
        "id": "q031_b",
        "text": "Select the \"Detect-Only\" template. Disable hash blocking and exclusions."
      },
      {
        "id": "q031_c",
        "text": "You can't create a policy that detects but does not prevent. Use Custom IOA rules to detect."
      },
      {
        "id": "q031_d",
        "text": "Set the Next-Gen Antivirus detection settings to the desired detection level and all the prevention sliders to disabled. Do not activate any of the other blocking or malware prevention options."
      }
    ],
    "correctOptionId": "q031_d",
    "explanation": ""
  },
  {
    "id": "q032",
    "prompt": "Which of the following is an effective Custom IOA rule pattern to kill any process attempting to access www.badguydomain.com?",
    "options": [
      {
        "id": "q032_a",
        "text": ".*badguydomain\\.com.*"
      },
      {
        "id": "q032_b",
        "text": "\\Device\\HarddiskVolume2\\*.exe -SingleArgument www.badguydomain.com /kill"
      },
      {
        "id": "q032_c",
        "text": "badguydomain\\.com.*"
      },
      {
        "id": "q032_d",
        "text": "Custom IOA rules cannot be created for domains"
      }
    ],
    "correctOptionId": "q032_a",
    "explanation": ""
  },
  {
    "id": "q033",
    "prompt": "Where can you modify settings to permit certain traffic during a containment period?",
    "options": [
      {
        "id": "q033_a",
        "text": "Prevention Policy"
      },
      {
        "id": "q033_b",
        "text": "Host Settings"
      },
      {
        "id": "q033_c",
        "text": "Containment Policy"
      },
      {
        "id": "q033_d",
        "text": "Firewall Settings"
      }
    ],
    "correctOptionId": "q033_c",
    "explanation": ""
  },
  {
    "id": "q034",
    "prompt": "Which option allows you to exclude behavioral detections from the detections page?",
    "options": [
      {
        "id": "q034_a",
        "text": "Machine Learning Exclusion"
      },
      {
        "id": "q034_b",
        "text": "IOA Exclusion"
      },
      {
        "id": "q034_c",
        "text": "IOC Exclusion"
      },
      {
        "id": "q034_d",
        "text": "Sensor Visibility Exclusion"
      }
    ],
    "correctOptionId": "q034_b",
    "explanation": ""
  },
  {
    "id": "q035",
    "prompt": "What are custom alerts based on?",
    "options": [
      {
        "id": "q035_a",
        "text": "Custom workflows"
      },
      {
        "id": "q035_b",
        "text": "Custom event based triggers"
      },
      {
        "id": "q035_c",
        "text": "Predefined alert templates"
      },
      {
        "id": "q035_d",
        "text": "User defined Splunk queries"
      }
    ],
    "correctOptionId": "q035_c",
    "explanation": ""
  },
  {
    "id": "q036",
    "prompt": "When creating an API client, which of the following must be saved immediately since it cannot be viewed again after the client is created?",
    "options": [
      {
        "id": "q036_a",
        "text": "Base URL"
      },
      {
        "id": "q036_b",
        "text": "Secret"
      },
      {
        "id": "q036_c",
        "text": "Client ID"
      },
      {
        "id": "q036_d",
        "text": "Client name"
      }
    ],
    "correctOptionId": "q036_b",
    "explanation": ""
  },
  {
    "id": "q037",
    "prompt": "You notice there are multiple Windows hosts in Reduced functionality mode (RFM). What is the most likely culprit causing these hosts to be in RFM?",
    "options": [
      {
        "id": "q037_a",
        "text": "A Sensor Update Policy was misconfigured"
      },
      {
        "id": "q037_b",
        "text": "A host was offline for more than 24 hours"
      },
      {
        "id": "q037_c",
        "text": "A patch was pushed overnight to all Windows systems"
      },
      {
        "id": "q037_d",
        "text": "A host was placed in network containment from a detection"
      }
    ],
    "correctOptionId": "q037_c",
    "explanation": ""
  },
  {
    "id": "q038",
    "prompt": "Which of the following is TRUE of the Logon Activities Report?",
    "options": [
      {
        "id": "q038_a",
        "text": "Shows a graphical view of user logon activity and the hosts the user connected to"
      },
      {
        "id": "q038_b",
        "text": "The report can be filtered by computer name"
      },
      {
        "id": "q038_c",
        "text": "It gives a detailed list of all logon activity for users"
      },
      {
        "id": "q038_d",
        "text": "It only gives a summary of the last logon activity for users"
      }
    ],
    "correctOptionId": "q038_d",
    "explanation": ""
  },
  {
    "id": "q039",
    "prompt": "Which of the following roles allows a Falcon user to create Real Time Response Custom Scripts?",
    "options": [
      {
        "id": "q039_a",
        "text": "Real Time Responder – Administrator"
      },
      {
        "id": "q039_b",
        "text": "Real Time Responder – Read Only Analyst"
      },
      {
        "id": "q039_c",
        "text": "Real Time Responder – Script Developer"
      },
      {
        "id": "q039_d",
        "text": "Real Time Responder – Active Responder"
      }
    ],
    "correctOptionId": "q039_a",
    "explanation": ""
  },
  {
    "id": "q040",
    "prompt": "What model is used to create workflows that would allow you to create custom notifications based on particular events which occur in the Falcon platform?",
    "options": [
      {
        "id": "q040_a",
        "text": "For - While statement(s)"
      },
      {
        "id": "q040_b",
        "text": "Trigger, condition(s) and action(s)"
      },
      {
        "id": "q040_c",
        "text": "Event trigger(s)"
      },
      {
        "id": "q040_d",
        "text": "Predefined workflow template(s)"
      }
    ],
    "correctOptionId": "q040_b",
    "explanation": ""
  },
  {
    "id": "q041",
    "prompt": "An analyst is asked to retrieve an API client secret from a previously generated key. How can they achieve this?",
    "options": [
      {
        "id": "q041_a",
        "text": "The API client secret can be viewed from the Edit API client pop-up box"
      },
      {
        "id": "q041_b",
        "text": "Enable the Client Secret column to reveal the API client secret"
      },
      {
        "id": "q041_c",
        "text": "Re-create the API client using the exact name to see the API client secret"
      },
      {
        "id": "q041_d",
        "text": "The API client secret cannot be retrieved after it has been created"
      }
    ],
    "correctOptionId": "q041_d",
    "explanation": ""
  },
  {
    "id": "q042",
    "prompt": "Which port and protocol does the sensor use to communicate with the CrowdStrike Cloud?",
    "options": [
      {
        "id": "q042_a",
        "text": "TCP port 22 (SSH)"
      },
      {
        "id": "q042_b",
        "text": "TCP port 443 (HTTPS)"
      },
      {
        "id": "q042_c",
        "text": "TCP port 80 (HTTP)"
      },
      {
        "id": "q042_d",
        "text": "TCP UDP port 53 (DNS)"
      }
    ],
    "correctOptionId": "q042_b",
    "explanation": ""
  },
  {
    "id": "q043",
    "prompt": "Where do you obtain the Windows sensor installer for CrowdStrike Falcon?",
    "options": [
      {
        "id": "q043_a",
        "text": "Sensors are downloaded from the Hosts > Sensor Downloads"
      },
      {
        "id": "q043_b",
        "text": "Sensor installers are unique to each customer and must be obtained from support"
      },
      {
        "id": "q043_c",
        "text": "Sensor installers are downloaded from the Support section of the CrowdStrike website"
      },
      {
        "id": "q043_d",
        "text": "Sensor installers are not used because sensors are deployed from within Falcon"
      }
    ],
    "correctOptionId": "q043_a",
    "explanation": ""
  },
  {
    "id": "q044",
    "prompt": "What is the most common cause of a Windows Sensor entering Reduced Functionality Mode (RFM)?",
    "options": [
      {
        "id": "q044_a",
        "text": "Falcon console updates are pending"
      },
      {
        "id": "q044_b",
        "text": "Falcon sensors installing an update"
      },
      {
        "id": "q044_c",
        "text": "Notifications have been disabled on that host sensor"
      },
      {
        "id": "q044_d",
        "text": "Microsoft updates"
      }
    ],
    "correctOptionId": "q044_d",
    "explanation": ""
  },
  {
    "id": "q045",
    "prompt": "On which page of the Falcon console would you create sensor groups?",
    "options": [
      {
        "id": "q045_a",
        "text": "User management"
      },
      {
        "id": "q045_b",
        "text": "Sensor update policies"
      },
      {
        "id": "q045_c",
        "text": "Host management"
      },
      {
        "id": "q045_d",
        "text": "Host groups"
      }
    ],
    "correctOptionId": "q045_d",
    "explanation": ""
  },
  {
    "id": "q046",
    "prompt": "While a host is Network contained, you need to allow the host to access internal network resources on specific IP addresses to perform patching and remediation. Which configuration would you choose?",
    "options": [
      {
        "id": "q046_a",
        "text": "Configure a Real Time Response policy allowlist with the specific IP addresses"
      },
      {
        "id": "q046_b",
        "text": "Configure a Containment Policy with the specific IP addresses"
      },
      {
        "id": "q046_c",
        "text": "Configure a Containment Policy with the entire internal IP CIDR block"
      },
      {
        "id": "q046_d",
        "text": "Configure the Host firewall to allowlist the specific IP addresses"
      }
    ],
    "correctOptionId": "q046_b",
    "explanation": ""
  },
  {
    "id": "q047",
    "prompt": "Which of the following is TRUE regarding Falcon Next-Gen AntiVirus (NGAV)?",
    "options": [
      {
        "id": "q047_a",
        "text": "Falcon NGAV relies on signature-based detections"
      },
      {
        "id": "q047_b",
        "text": "Activating Falcon NGAV will also enable all detection and prevention settings in the entire policy"
      },
      {
        "id": "q047_c",
        "text": "The Detection sliders cannot be set to a value less aggressive than the Prevention sliders"
      },
      {
        "id": "q047_d",
        "text": "Falcon NGAV is not a replacement for Windows Defender or other antivirus programs"
      }
    ],
    "correctOptionId": "q047_c",
    "explanation": ""
  },
  {
    "id": "q048",
    "prompt": "What is the purpose of using groups with Sensor Update policies in CrowdStrike Falcon?",
    "options": [
      {
        "id": "q048_a",
        "text": "To group hosts with others in the same business unit"
      },
      {
        "id": "q048_b",
        "text": "To group hosts according to the order in which Falcon was installed, so that updates are installed in the same order every time"
      },
      {
        "id": "q048_c",
        "text": "To prioritize the order in which Falcon updates are installed, so that updates are not installed all at once leading to network congestion"
      },
      {
        "id": "q048_d",
        "text": "To allow the controlled assignment of sensor versions onto specific hosts"
      }
    ],
    "correctOptionId": "q048_d",
    "explanation": ""
  },
  {
    "id": "q049",
    "prompt": "What impact does disabling detections on a host have on an API?",
    "options": [
      {
        "id": "q049_a",
        "text": "Endpoints with detections disabled will not alert on anything until detections are enabled again"
      },
      {
        "id": "q049_b",
        "text": "Endpoints cannot have their detections disabled individually"
      },
      {
        "id": "q049_c",
        "text": "DetectionSummaryEvent stops sending to the Streaming API for that host"
      },
      {
        "id": "q049_d",
        "text": "Endpoints with detections disabled will not alert on anything for 24 hours (by default) or longer if that setting is changed"
      }
    ],
    "correctOptionId": "q049_c",
    "explanation": ""
  },
  {
    "id": "q050",
    "prompt": "Under which scenario can Sensor Tags be assigned?",
    "options": [
      {
        "id": "q050_a",
        "text": "While triaging a detection"
      },
      {
        "id": "q050_b",
        "text": "While managing hosts in the Falcon console"
      },
      {
        "id": "q050_c",
        "text": "While updating a sensor in the Falcon console"
      },
      {
        "id": "q050_d",
        "text": "While installing a sensor"
      }
    ],
    "correctOptionId": "q050_d",
    "explanation": ""
  },
  {
    "id": "q051",
    "prompt": "Custom IOA rules are defined using which syntax?",
    "options": [
      {
        "id": "q051_a",
        "text": "Glob"
      },
      {
        "id": "q051_b",
        "text": "PowerShell"
      },
      {
        "id": "q051_c",
        "text": "Yara"
      },
      {
        "id": "q051_d",
        "text": "Regex"
      }
    ],
    "correctOptionId": "q051_d",
    "explanation": ""
  },
  {
    "id": "q052",
    "prompt": "With Custom Alerts, it is possible to __________.",
    "options": [
      {
        "id": "q052_a",
        "text": "schedule the alert to run at any interval"
      },
      {
        "id": "q052_b",
        "text": "receive an alert in an email"
      },
      {
        "id": "q052_c",
        "text": "configure prevention actions for alerting"
      },
      {
        "id": "q052_d",
        "text": "be alerted to activity in real-time"
      }
    ],
    "correctOptionId": "q052_b",
    "explanation": ""
  },
  {
    "id": "q053",
    "prompt": "You have been provided with a list of 100 hashes that are not malicious but your company has deemed to be inappropriate for work computers. They have asked you to ensure that they are not allowed to run in your environment. You have chosen to use Falcon to do this. Which is the best way to accomplish this?",
    "options": [
      {
        "id": "q053_a",
        "text": "Using the Support Portal, create a support ticket and include the list of binary hashes, asking support to create an \"Execution Prevention\" rule to prevent these processes from running"
      },
      {
        "id": "q053_b",
        "text": "Using Custom Alerts in the Investigate App, create a new alert using the template \"Process Execution\" and within that rule, select the option to \"Block Execution\""
      },
      {
        "id": "q053_c",
        "text": "Using IOC Management, gather the list of SHA256 or MD5 hashes for each binary and then upload them. Set all hashes to \"Block\" and ensure that the prevention policy these computers are using includes the option for \"Custom Blocking\" under Execution Blocking."
      },
      {
        "id": "q053_d",
        "text": "Using the API, gather the list of SHA256 or MD5 hashes for each binary and then upload them, setting them all to \"Never Allow\"."
      }
    ],
    "correctOptionId": "q053_c",
    "explanation": ""
  },
  {
    "id": "q054",
    "prompt": "How do you assign a Prevention policy to one or more hosts?",
    "options": [
      {
        "id": "q054_a",
        "text": "Create a new policy and assign it directly to those hosts on the Host Management page"
      },
      {
        "id": "q054_b",
        "text": "Modify the users roles on the User Management page"
      },
      {
        "id": "q054_c",
        "text": "Ensure the hosts are in a group and assign that group to a custom Prevention policy"
      },
      {
        "id": "q054_d",
        "text": "Create a new policy and assign it directly to those hosts on the Prevention policy page"
      }
    ],
    "correctOptionId": "q054_c",
    "explanation": ""
  },
  {
    "id": "q055",
    "prompt": "Which exclusion pattern will prevent detections on a file at C:\\Program Files\\My Program\\My Files\\program.exe?",
    "options": [
      {
        "id": "q055_a",
        "text": "\\Program Files\\My Program\\My Files\\*"
      },
      {
        "id": "q055_b",
        "text": "\\Program Files\\My Program\\*"
      },
      {
        "id": "q055_c",
        "text": "*\\*"
      },
      {
        "id": "q055_d",
        "text": "*\\Program Files\\My Program\\*\\"
      }
    ],
    "correctOptionId": "q055_a",
    "explanation": ""
  },
  {
    "id": "q056",
    "prompt": "When a host is placed in Network Containment, which of the following is TRUE?",
    "options": [
      {
        "id": "q056_a",
        "text": "The host machine is unable to send or receive network traffic outside of the local network"
      },
      {
        "id": "q056_b",
        "text": "The host machine is unable to send or receive network traffic except to/from the Falcon Cloud and traffic allowed in the Firewall Policy"
      },
      {
        "id": "q056_c",
        "text": "The host machine is unable to send or receive any network traffic"
      },
      {
        "id": "q056_d",
        "text": "The host machine is unable to send or receive network traffic except to/from the Falcon Cloud and any resources allowlisted in the Containment Policy"
      }
    ],
    "correctOptionId": "q056_d",
    "explanation": ""
  },
  {
    "id": "q057",
    "prompt": "When would the No Action option be assigned to a hash in IOC Management?",
    "options": [
      {
        "id": "q057_a",
        "text": "When you want to save the indicator for later action, but do not want to block or allow it at this time"
      },
      {
        "id": "q057_b",
        "text": "Add the indicator to your allowlist and do not detect it"
      },
      {
        "id": "q057_c",
        "text": "There is no such option as No Action available in the Falcon console"
      },
      {
        "id": "q057_d",
        "text": "Add the indicator to your blocklist and show it as a detection"
      }
    ],
    "correctOptionId": "q057_a",
    "explanation": ""
  },
  {
    "id": "q058",
    "prompt": "Why is it important to know your company's event data retention limits in the Falcon platform?",
    "options": [
      {
        "id": "q058_a",
        "text": "This is not necessary; you simply select \"All Time\" in your query to search all data"
      },
      {
        "id": "q058_b",
        "text": "You will not be able to search event data into the past beyond your retention period"
      },
      {
        "id": "q058_c",
        "text": "Data such as process records are kept for a shorter time than event data"
      },
      {
        "id": "q058_d",
        "text": "Your query will require you to specify the data pool associated with the date you wish to search"
      }
    ],
    "correctOptionId": "q058_b",
    "explanation": ""
  },
  {
    "id": "q059",
    "prompt": "What is the purpose of precedence with respect to the Sensor Update policy?",
    "options": [
      {
        "id": "q059_a",
        "text": "Precedence applies to the Prevention policy and not to the Sensor Update policy"
      },
      {
        "id": "q059_b",
        "text": "Hosts assigned to multiple policies will assume the highest ranked policy in the list (policy with the lowest number)"
      },
      {
        "id": "q059_c",
        "text": "Hosts assigned to multiple policies will assume the lowest ranked policy in the list (policy with the highest number)"
      },
      {
        "id": "q059_d",
        "text": "Precedence ensures that conflicting policy settings are not set in the same policy"
      }
    ],
    "correctOptionId": "q059_b",
    "explanation": ""
  },
  {
    "id": "q060",
    "prompt": "When uninstalling a sensor, which of the following is required if the 'Uninstall and maintenance protection' setting is enabled within the Sensor Update Policies?",
    "options": [
      {
        "id": "q060_a",
        "text": "Maintenance token"
      },
      {
        "id": "q060_b",
        "text": "Customer ID (CID)"
      },
      {
        "id": "q060_c",
        "text": "Bulk update key"
      },
      {
        "id": "q060_d",
        "text": "Agent ID (AID)"
      }
    ],
    "correctOptionId": "q060_a",
    "explanation": ""
  },
  {
    "id": "q061",
    "prompt": "How can a Falcon Administrator configure a pop-up message to be displayed on a host when the Falcon sensor blocks, kills or quarantines an activity?",
    "options": [
      {
        "id": "q061_a",
        "text": "By ensuring each user has set the \"pop-ups allowed\" in their User Profile configuration page"
      },
      {
        "id": "q061_b",
        "text": "By enabling \"Upload quarantined files\" in the General Settings configuration page"
      },
      {
        "id": "q061_c",
        "text": "By turning on the \"Notify End Users\" setting at the top of the Prevention policy details configuration page"
      },
      {
        "id": "q061_d",
        "text": "By selecting \"Enable pop-up messages\" from the User configuration page"
      }
    ],
    "correctOptionId": "q061_c",
    "explanation": ""
  },
  {
    "id": "q062",
    "prompt": "Where in the Falcon console can information about supported operating system versions be found?",
    "options": [
      {
        "id": "q062_a",
        "text": "Configuration module"
      },
      {
        "id": "q062_b",
        "text": "Intelligence module"
      },
      {
        "id": "q062_c",
        "text": "Support module"
      },
      {
        "id": "q062_d",
        "text": "Discover module"
      }
    ],
    "correctOptionId": "q062_c",
    "explanation": ""
  },
  {
    "id": "q063",
    "prompt": "What is the name for the unique host identifier in Falcon assigned to each sensor during sensor installation?",
    "options": [
      {
        "id": "q063_a",
        "text": "Endpoint ID (EID)"
      },
      {
        "id": "q063_b",
        "text": "Agent ID (AID)"
      },
      {
        "id": "q063_c",
        "text": "Security ID (SID)"
      },
      {
        "id": "q063_d",
        "text": "Computer ID (CID)"
      }
    ],
    "correctOptionId": "q063_b",
    "explanation": ""
  },
  {
    "id": "q064",
    "prompt": "Which of the following is a valid step when troubleshooting sensor installation failure?",
    "options": [
      {
        "id": "q064_a",
        "text": "Confirm all required services are running on the system"
      },
      {
        "id": "q064_b",
        "text": "Enable the Windows firewall"
      },
      {
        "id": "q064_c",
        "text": "Disable SSL and TLS on the host"
      },
      {
        "id": "q064_d",
        "text": "Delete any available application crash log files"
      }
    ],
    "correctOptionId": "q064_a",
    "explanation": ""
  },
  {
    "id": "q065",
    "prompt": "You need to export a list of all detections for a specific Host Name in the last 24 hours. What is the best way to do this?",
    "options": [
      {
        "id": "q065_a",
        "text": "Go to Host Management in the Host page. Select the host and use the Export Detections button"
      },
      {
        "id": "q065_b",
        "text": "Utilize the Detection Resolution Dashboard. Use the filters to focus on the appropriate hostname and time, then export the results from the \"Detection Resolution History\" section"
      },
      {
        "id": "q065_c",
        "text": "In the Investigate module, access the Detection Activity page. Use the filters to focus on the appropriate hostname and time, then export the results"
      },
      {
        "id": "q065_d",
        "text": "Utilize the Detection Activity Dashboard. Use the filters to focus on the appropriate hostname and time, then export the results from the \"Detections by Host\" section"
      }
    ],
    "correctOptionId": "q065_c",
    "explanation": ""
  },
  {
    "id": "q066",
    "prompt": "Which role will allow someone to manage quarantine files?",
    "options": [
      {
        "id": "q066_a",
        "text": "Falcon Security Lead"
      },
      {
        "id": "q066_b",
        "text": "Detections Exceptions Manager"
      },
      {
        "id": "q066_c",
        "text": "Falcon Analyst – Read Only"
      },
      {
        "id": "q066_d",
        "text": "Endpoint Manager"
      }
    ],
    "correctOptionId": "q066_a",
    "explanation": ""
  },
  {
    "id": "q067",
    "prompt": "What is the maximum number of patterns that can be added when creating a new exclusion?",
    "options": [
      {
        "id": "q067_a",
        "text": "10"
      },
      {
        "id": "q067_b",
        "text": "0"
      },
      {
        "id": "q067_c",
        "text": "1"
      },
      {
        "id": "q067_d",
        "text": "5"
      }
    ],
    "correctOptionId": "q067_c",
    "explanation": ""
  },
  {
    "id": "q068",
    "prompt": "You are evaluating the most appropriate Prevention Policy Machine Learning slider settings for your environment. In your testing phase, you configure the Detection slider as Aggressive. After running the sensor with this configuration for 1 week of testing, which Audit report should you review to determine the best Machine Learning slider settings for your organization?",
    "options": [
      {
        "id": "q068_a",
        "text": "Prevention Policy Audit Trail"
      },
      {
        "id": "q068_b",
        "text": "Prevention Policy Debug"
      },
      {
        "id": "q068_c",
        "text": "Prevention Hashes Ignored"
      },
      {
        "id": "q068_d",
        "text": "Machine-Learning Prevention Monitoring"
      }
    ],
    "correctOptionId": "q068_d",
    "explanation": ""
  },
  {
    "id": "q069",
    "prompt": "In order to exercise manual control over the sensor upgrade process, as well as prevent unauthorized users from uninstalling or upgrading the sensor, which settings in the Sensor Update Policy would meet this criteria?",
    "options": [
      {
        "id": "q069_a",
        "text": "Sensor version set to N-1 and Bulk maintenance mode is turned on"
      },
      {
        "id": "q069_b",
        "text": "Sensor version fixed and Uninstall and maintenance protection turned on"
      },
      {
        "id": "q069_c",
        "text": "Sensor version updates off and Uninstall and maintenance protection turned off"
      },
      {
        "id": "q069_d",
        "text": "Sensor version set to N-2 and Bulk maintenance mode is turned on"
      }
    ],
    "correctOptionId": "q069_b",
    "explanation": ""
  },
  {
    "id": "q070",
    "prompt": "Once an exclusion is saved, what can be edited in the future?",
    "options": [
      {
        "id": "q070_a",
        "text": "All parts of the exclusion can be changed"
      },
      {
        "id": "q070_b",
        "text": "Only the selected groups and hosts to which the exclusion is applied can be changed"
      },
      {
        "id": "q070_c",
        "text": "Only the options to \"Detect/Block\" and/or \"File Extraction\" can be changed"
      },
      {
        "id": "q070_d",
        "text": "The exclusion pattern cannot be changed"
      }
    ],
    "correctOptionId": "q070_a",
    "explanation": ""
  },
  {
    "id": "q071",
    "prompt": "Which of the following options is a feature found ONLY with the Sensor-based Machine Learning (ML)?",
    "options": [
      {
        "id": "q071_a",
        "text": "Next-Gen Antivirus (NGAV) protection"
      },
      {
        "id": "q071_b",
        "text": "Adware and Potentially Unwanted Program detection and prevention"
      },
      {
        "id": "q071_c",
        "text": "Real-time offline protection"
      },
      {
        "id": "q071_d",
        "text": "Identification and analysis of unknown executables"
      }
    ],
    "correctOptionId": "q071_c",
    "explanation": ""
  },
  {
    "id": "q072",
    "prompt": "How do you find a list of inactive sensors?",
    "options": [
      {
        "id": "q072_a",
        "text": "The Falcon platform does not provide reporting for inactive sensors"
      },
      {
        "id": "q072_b",
        "text": "A sensor is always considered active until removed by an Administrator"
      },
      {
        "id": "q072_c",
        "text": "Run the Inactive Sensor Report in the Host setup and management option"
      },
      {
        "id": "q072_d",
        "text": "Run the Sensor Aging Report within the Investigate option"
      }
    ],
    "correctOptionId": "q072_c",
    "explanation": ""
  },
  {
    "id": "q073",
    "prompt": "Which report can assist in determining the appropriate Machine Learning levels to set in a Prevention Policy?",
    "options": [
      {
        "id": "q073_a",
        "text": "Sensor Report"
      },
      {
        "id": "q073_b",
        "text": "Machine Learning Prevention Monitoring"
      },
      {
        "id": "q073_c",
        "text": "Falcon UI Audit Trail"
      },
      {
        "id": "q073_d",
        "text": "Machine Learning Debug"
      }
    ],
    "correctOptionId": "q073_b",
    "explanation": ""
  },
  {
    "id": "q074",
    "prompt": "Why is the ability to disable detections helpful?",
    "options": [
      {
        "id": "q074_a",
        "text": "It gives users the ability to set up hosts to test detections and later remove them from the console"
      },
      {
        "id": "q074_b",
        "text": "It gives users the ability to uninstall the sensor from a host"
      },
      {
        "id": "q074_c",
        "text": "It gives users the ability to allowlist a false positive detection"
      },
      {
        "id": "q074_d",
        "text": "It gives users the ability to remove all data from hosts that have been uninstalled"
      }
    ],
    "correctOptionId": "q074_a",
    "explanation": ""
  },
  {
    "id": "q075",
    "prompt": "The Logon Activities Report includes all of the following information for a particular user EXCEPT __________.",
    "options": [
      {
        "id": "q075_a",
        "text": "the account type for the user (e.g. Domain Administrator, Local User)"
      },
      {
        "id": "q075_b",
        "text": "all hosts the user logged into"
      },
      {
        "id": "q075_c",
        "text": "the logon type (e.g. interactive, service)"
      },
      {
        "id": "q075_d",
        "text": "the last time the user's password was set"
      }
    ],
    "correctOptionId": "q075_b",
    "explanation": ""
  },
  {
    "id": "q076",
    "prompt": "An analyst has reported they are not receiving workflow triggered notifications in the past few days. Where should you first check for potential failures?",
    "options": [
      {
        "id": "q076_a",
        "text": "Custom Alert History"
      },
      {
        "id": "q076_b",
        "text": "Workflow Execution log"
      },
      {
        "id": "q076_c",
        "text": "Workflow Audit log"
      },
      {
        "id": "q076_d",
        "text": "Falcon UI Audit Trail"
      }
    ],
    "correctOptionId": "q076_b",
    "explanation": ""
  },
  {
    "id": "q077",
    "prompt": "You have an existing workflow that is triggered on a critical detection that sends an email to the escalation team. Your CISO has asked to also be notified via email with a customized message. What is the best way to update the workflow?",
    "options": [
      {
        "id": "q077_a",
        "text": "Clone the workflow and replace the existing email with your CISO's email"
      },
      {
        "id": "q077_b",
        "text": "Add a sequential action to send a custom email to your CISO"
      },
      {
        "id": "q077_c",
        "text": "Add a parallel action to send a custom email to your CISO"
      },
      {
        "id": "q077_d",
        "text": "Add the CISO's email to the existing action"
      }
    ],
    "correctOptionId": "q077_c",
    "explanation": ""
  },
  {
    "id": "q078",
    "prompt": "Which of the following is NOT an available filter on the Hosts Management page?",
    "options": [
      {
        "id": "q078_a",
        "text": "Hostname"
      },
      {
        "id": "q078_b",
        "text": "Username"
      },
      {
        "id": "q078_c",
        "text": "Group"
      },
      {
        "id": "q078_d",
        "text": "OS Version"
      }
    ],
    "correctOptionId": "q078_b",
    "explanation": ""
  },
  {
    "id": "q079",
    "prompt": "What is the primary purpose of using glob syntax in an exclusion?",
    "options": [
      {
        "id": "q079_a",
        "text": "To specify a Domain be excluded from detections"
      },
      {
        "id": "q079_b",
        "text": "To specify exclusion patterns to easily exclude files and folders and extensions from detections"
      },
      {
        "id": "q079_c",
        "text": "To specify exclusion patterns to easily add files and folders and extensions to be prevented"
      },
      {
        "id": "q079_d",
        "text": "To specify a network share be excluded from detections"
      }
    ],
    "correctOptionId": "q079_b",
    "explanation": ""
  },
  {
    "id": "q080",
    "prompt": "How are user permissions set in Falcon?",
    "options": [
      {
        "id": "q080_a",
        "text": "Permissions are assigned to a User Group and then users are assigned to that group, thereby inheriting those permissions"
      },
      {
        "id": "q080_b",
        "text": "Pre-defined permissions are assigned to sets called roles. Users can be assigned multiple roles based on job function and they assume a cumulative set of permissions based on those assignments"
      },
      {
        "id": "q080_c",
        "text": "An administrator selects individual granular permissions from the Falcon Permissions List during user creation"
      },
      {
        "id": "q080_d",
        "text": "Permissions are token-based. Users request access to a defined set of permissions and an administrator adds their token to the set of permissions"
      }
    ],
    "correctOptionId": "q080_b",
    "explanation": ""
  },
  {
    "id": "q081",
    "prompt": "Which of the following is NOT a way to determine the sensor version installed on a specific endpoint?",
    "options": [
      {
        "id": "q081_a",
        "text": "Use the Sensor Report to filter to the specific endpoint"
      },
      {
        "id": "q081_b",
        "text": "Use Host Management to select the desired endpoint. The agent version will be listed in the columns and details"
      },
      {
        "id": "q081_c",
        "text": "From a command line, run the sc query csagent -version command"
      },
      {
        "id": "q081_d",
        "text": "Use the Investigate > Host Search to filter to the specific endpoint"
      }
    ],
    "correctOptionId": "q081_c",
    "explanation": ""
  },
  {
    "id": "q082",
    "prompt": "What is the correct order for manually installing a Falcon Package on a macOS system?",
    "options": [
      {
        "id": "q082_a",
        "text": "Install the Falcon package, then register the Falcon Sensor via the registration package"
      },
      {
        "id": "q082_b",
        "text": "Install the Falcon package, then register the Falcon Sensor via command line"
      },
      {
        "id": "q082_c",
        "text": "Register the Falcon Sensor via command line, then install the Falcon package"
      },
      {
        "id": "q082_d",
        "text": "Register the Falcon Sensor via the registration package, then install the Falcon package"
      }
    ],
    "correctOptionId": "q082_b",
    "explanation": ""
  },
  {
    "id": "q083",
    "prompt": "You are beginning the rollout of the Falcon Sensor for the first time side-by-side with your existing security solution. You need to configure the Machine Learning levels of the Prevention Policy so it does not interfere with existing solutions during the testing phase. What settings do you choose?",
    "options": [
      {
        "id": "q083_a",
        "text": "- Detection slider: Extra Aggressive - Prevention slider: Cautious"
      },
      {
        "id": "q083_b",
        "text": "- Detection slider: Moderate - Prevention slider: Disabled"
      },
      {
        "id": "q083_c",
        "text": "- Detection slider: Cautious - Prevention slider: Cautious"
      },
      {
        "id": "q083_d",
        "text": "- Detection slider: Disabled - Prevention slider: Disabled"
      }
    ],
    "correctOptionId": "q083_b",
    "explanation": ""
  },
  {
    "id": "q084",
    "prompt": "How does the Unique Hosts Connecting to Countries Map help an administrator?",
    "options": [
      {
        "id": "q084_a",
        "text": "It highlights countries with known malware"
      },
      {
        "id": "q084_b",
        "text": "It helps visualize global network communication"
      },
      {
        "id": "q084_c",
        "text": "It identifies connections containing threats"
      },
      {
        "id": "q084_d",
        "text": "It displays intrusions from foreign countries by"
      }
    ],
    "correctOptionId": "q084_b",
    "explanation": ""
  },
  {
    "id": "q085",
    "prompt": "On a Windows host, what is the best command to determine if the sensor is currently running?",
    "options": [
      {
        "id": "q085_a",
        "text": "sc query csagent"
      },
      {
        "id": "q085_b",
        "text": "netstat -a"
      },
      {
        "id": "q085_c",
        "text": "This cannot be accomplished with a command"
      },
      {
        "id": "q085_d",
        "text": "ping falcon.crowdstrike.com"
      }
    ],
    "correctOptionId": "q085_a",
    "explanation": ""
  },
  {
    "id": "q086",
    "prompt": "The Falcon sensor uses certificate pinning to defend against man-in-the-middle attacks. Which statement is TRUE concerning Falcon sensor certificate validation?",
    "options": [
      {
        "id": "q086_a",
        "text": "SSL inspection should be configured to occur on all Falcon traffic"
      },
      {
        "id": "q086_b",
        "text": "Some network configurations, such as deep packet inspection, interfere with certificate validation"
      },
      {
        "id": "q086_c",
        "text": "HTTPS interception should be enabled to proceed with certificate validation"
      },
      {
        "id": "q086_d",
        "text": "Common sources of interference with certificate pinning include protocol race conditions and resource contention"
      }
    ],
    "correctOptionId": "q086_b",
    "explanation": ""
  },
  {
    "id": "q087",
    "prompt": "Which is a filter within the Host setup and management > Host management page?",
    "options": [
      {
        "id": "q087_a",
        "text": "User name"
      },
      {
        "id": "q087_b",
        "text": "OU"
      },
      {
        "id": "q087_c",
        "text": "BIOS Version"
      },
      {
        "id": "q087_d",
        "text": "Locality"
      }
    ],
    "correctOptionId": "q087_b",
    "explanation": ""
  },
  {
    "id": "q088",
    "prompt": "When creating a Host Group for all Workstations in an environment, what is the best method to ensure all workstation hosts are added to the group?",
    "options": [
      {
        "id": "q088_a",
        "text": "Create a Dynamic Group with Type=Workstation Assignment"
      },
      {
        "id": "q088_b",
        "text": "Create a Dynamic Group and Import All Workstations"
      },
      {
        "id": "q088_c",
        "text": "Create a Static Group and Import all Workstations"
      },
      {
        "id": "q088_d",
        "text": "Create a Static Group with Type=Workstation Assignment"
      }
    ],
    "correctOptionId": "q088_a",
    "explanation": ""
  },
  {
    "id": "q089",
    "prompt": "When the Notify End Users policy setting is turned on, which of the following is TRUE?",
    "options": [
      {
        "id": "q089_a",
        "text": "End users will not be notified as we would not want to notify a malicious actor of a detection. This setting does not exist"
      },
      {
        "id": "q089_b",
        "text": "End users will be immediately notified via a pop-up that their machine is in-network isolation"
      },
      {
        "id": "q089_c",
        "text": "End-users receive a pop-up notification when a prevention action occurs"
      },
      {
        "id": "q089_d",
        "text": "End users will receive a pop-up allowing them to confirm or refuse a pending quarantine"
      }
    ],
    "correctOptionId": "q089_c",
    "explanation": ""
  },
  {
    "id": "q090",
    "prompt": "If a user wanted to install an older version of the Falcon sensor, how would they find the older installer file?",
    "options": [
      {
        "id": "q090_a",
        "text": "Older versions of the sensor are not available for download"
      },
      {
        "id": "q090_b",
        "text": "By emailing CrowdStrike support at support@crowdstrike.com"
      },
      {
        "id": "q090_c",
        "text": "By installing the current sensor and clicking the \"downgrade\" button during the install"
      },
      {
        "id": "q090_d",
        "text": "By clicking on \"Older versions\" links under the Host setup and management > Deploy > Sensor downloads by"
      }
    ],
    "correctOptionId": "q090_d",
    "explanation": ""
  },
  {
    "id": "q091",
    "prompt": "Which of the following best describes the Default Sensor Update policy?",
    "options": [
      {
        "id": "q091_a",
        "text": "The Default Sensor Update policy does not have the \"Uninstall and maintenance protection\" feature"
      },
      {
        "id": "q091_b",
        "text": "The Default Sensor Update policy is only used for testing sensor updates"
      },
      {
        "id": "q091_c",
        "text": "The Default Sensor Update policy is a \"catch-all\" policy"
      },
      {
        "id": "q091_d",
        "text": "The Default Sensor Update policy is disabled by default"
      }
    ],
    "correctOptionId": "q091_c",
    "explanation": ""
  },
  {
    "id": "q092",
    "prompt": "Under the \"Next-Gen Antivirus: Cloud Machine Learning\" setting there are two categories, one of them is \"Cloud Anti-Malware\" and the other is:",
    "options": [
      {
        "id": "q092_a",
        "text": "Adware & PUP"
      },
      {
        "id": "q092_b",
        "text": "Advanced Machine Learning"
      },
      {
        "id": "q092_c",
        "text": "Sensor Anti-Malware"
      },
      {
        "id": "q092_d",
        "text": "Execution Blocking"
      }
    ],
    "correctOptionId": "q092_a",
    "explanation": ""
  },
  {
    "id": "q093",
    "prompt": "You have created a Sensor Update Policy for the Mac platform. Which other operating system(s) will this policy manage?",
    "options": [
      {
        "id": "q093_a",
        "text": "*nix"
      },
      {
        "id": "q093_b",
        "text": "Windows"
      },
      {
        "id": "q093_c",
        "text": "Both Windows and *nix"
      },
      {
        "id": "q093_d",
        "text": "Only Mac"
      }
    ],
    "correctOptionId": "q093_d",
    "explanation": ""
  },
  {
    "id": "q094",
    "prompt": "Which of the following Machine Learning (ML) sliders will only detect or prevent high confidence malicious items?",
    "options": [
      {
        "id": "q094_a",
        "text": "Aggressive"
      },
      {
        "id": "q094_b",
        "text": "Cautious"
      },
      {
        "id": "q094_c",
        "text": "Minimal"
      },
      {
        "id": "q094_d",
        "text": "Moderate"
      }
    ],
    "correctOptionId": "q094_b",
    "explanation": ""
  },
  {
    "id": "q095",
    "prompt": "What type of information is found in the Linux Sensors Dashboard?",
    "options": [
      {
        "id": "q095_a",
        "text": "Hosts by Kernel Version, Shells spawned by Root, Wget/Curl Usage"
      },
      {
        "id": "q095_b",
        "text": "Hidden File execution, Execution of file from the trash, Versions Running with Computer Names"
      },
      {
        "id": "q095_c",
        "text": "Versions running, Directory Made Invisible to Spotlight, Logging/Auditing Referenced, Viewed, or Modified"
      },
      {
        "id": "q095_d",
        "text": "Private Information Accessed, Archiving Tools – Exfil, Files Made Executable"
      }
    ],
    "correctOptionId": "q095_a",
    "explanation": ""
  },
  {
    "id": "q096",
    "prompt": "Why would you assign hosts to a static group instead of a dynamic group?",
    "options": [
      {
        "id": "q096_a",
        "text": "You do not want the group membership to change automatically"
      },
      {
        "id": "q096_b",
        "text": "You are managing more than 1000 hosts"
      },
      {
        "id": "q096_c",
        "text": "You need hosts to be automatically assigned to a group"
      },
      {
        "id": "q096_d",
        "text": "You want the group to contain hosts from multiple operating systems"
      }
    ],
    "correctOptionId": "q096_a",
    "explanation": ""
  },
  {
    "id": "q097",
    "prompt": "What can exclusions be applied to?",
    "options": [
      {
        "id": "q097_a",
        "text": "Individual hosts selected by the administrator"
      },
      {
        "id": "q097_b",
        "text": "Either all hosts or specified groups"
      },
      {
        "id": "q097_c",
        "text": "Only the default host group"
      },
      {
        "id": "q097_d",
        "text": "Only the groups selected by the administrator"
      }
    ],
    "correctOptionId": "q097_b",
    "explanation": ""
  },
  {
    "id": "q098",
    "prompt": "You have a Windows host on your network in Reduced functionality mode (RFM). While the system is in RFM, which of the following is TRUE?",
    "options": [
      {
        "id": "q098_a",
        "text": "System monitoring will be unavailable"
      },
      {
        "id": "q098_b",
        "text": "Event reporting will be unavailable"
      },
      {
        "id": "q098_c",
        "text": "Prevention patterns will not be triggered"
      },
      {
        "id": "q098_d",
        "text": "Some detection patterns and preventions will not be triggered"
      }
    ],
    "correctOptionId": "q098_d",
    "explanation": ""
  },
  {
    "id": "q099",
    "prompt": "A sensor that has not contacted the Falcon cloud will be automatically deleted from the hosts list after how many days?",
    "options": [
      {
        "id": "q099_a",
        "text": "45 Days"
      },
      {
        "id": "q099_b",
        "text": "60 Days"
      },
      {
        "id": "q099_c",
        "text": "30 Days"
      },
      {
        "id": "q099_d",
        "text": "90 Days"
      }
    ],
    "correctOptionId": "q099_a",
    "explanation": ""
  },
  {
    "id": "q100",
    "prompt": "When a host belongs to more than one host group, how is sensor update precedence determined?",
    "options": [
      {
        "id": "q100_a",
        "text": "Groups have no impact on sensor update policies"
      },
      {
        "id": "q100_b",
        "text": "Sensors of hosts that belong to more than one group must be manually updated"
      },
      {
        "id": "q100_c",
        "text": "The highest precedence policy from the most important group is applied to the host"
      },
      {
        "id": "q100_d",
        "text": "All of the host's groups are examined in aggregate and the policy with highest precedence is applied to the host"
      }
    ],
    "correctOptionId": "q100_d",
    "explanation": ""
  },
  {
    "id": "q101",
    "prompt": "What may prevent a user from logging into Falcon via single sign-on (SSO)?",
    "options": [
      {
        "id": "q101_a",
        "text": "The SSO username doesn't match their email address in Falcon"
      },
      {
        "id": "q101_b",
        "text": "The maintenance token has expired"
      },
      {
        "id": "q101_c",
        "text": "Falcon is in reduced functionality mode"
      },
      {
        "id": "q101_d",
        "text": "The user never configured their security questions"
      }
    ],
    "correctOptionId": "q101_a",
    "explanation": ""
  },
  {
    "id": "q102",
    "prompt": "The Customer ID (CID) is important in which of the following scenarios?",
    "options": [
      {
        "id": "q102_a",
        "text": "When adding a user to the Falcon console under the Users application"
      },
      {
        "id": "q102_b",
        "text": "When performing the sensor installation process"
      },
      {
        "id": "q102_c",
        "text": "When setting up API keys"
      },
      {
        "id": "q102_d",
        "text": "When performing a Host Search"
      }
    ],
    "correctOptionId": "q102_b",
    "explanation": ""
  },
  {
    "id": "q103",
    "prompt": "Which statement describes what is recommended for the Default Sensor Update policy?",
    "options": [
      {
        "id": "q103_a",
        "text": "The Default Sensor Update policy should align to an organization's overall sensor updating practice while leveraging Auto N-1 and Auto N-2 configurations where possible"
      },
      {
        "id": "q103_b",
        "text": "The Default Sensor Update should be configured to always automatically upgrade to the latest sensor version"
      },
      {
        "id": "q103_c",
        "text": "Since the Default Sensor Update policy is pre-configured with recommend settings out of the box, configuration of the Default Sensor Update policy is not required"
      },
      {
        "id": "q103_d",
        "text": "No configuration is required. Once a Custom Sensor Update policy is created the Default Sensor Update policy is disabled"
      }
    ],
    "correctOptionId": "q103_a",
    "explanation": ""
  },
  {
    "id": "q104",
    "prompt": "You need to have the ability to monitor suspicious VBA macros. Which Sensor Visibility setting should be turned on within the Prevention policy settings?",
    "options": [
      {
        "id": "q104_a",
        "text": "Script-based Execution Monitoring"
      },
      {
        "id": "q104_b",
        "text": "Interpreter-Only"
      },
      {
        "id": "q104_c",
        "text": "Additional User Mode Data"
      },
      {
        "id": "q104_d",
        "text": "Engine (Full Visibility)"
      }
    ],
    "correctOptionId": "q104_a",
    "explanation": ""
  },
  {
    "id": "q105",
    "prompt": "What is the purpose of the Machine-Learning Prevention Monitoring Report?",
    "options": [
      {
        "id": "q105_a",
        "text": "It is designed to give an administrator a quick overview of machine-learning aggressiveness settings as well as the numbers of items actually quarantined"
      },
      {
        "id": "q105_b",
        "text": "It is the dashboard used by an analyst to view all items quarantined and to release any items deemed non-malicious"
      },
      {
        "id": "q105_c",
        "text": "It is the dashboard used to see machine-learning preventions, and it is used to identify spikes in activity and possible targeted attacks"
      },
      {
        "id": "q105_d",
        "text": "It is designed to show malware that would have been blocked in your environment based on different Machine-Learning Prevention settings"
      }
    ],
    "correctOptionId": "q105_d",
    "explanation": ""
  },
  {
    "id": "q106",
    "prompt": "In order to establish an RTR sesson, the host must be online and in a group that has RTR enabled- What else is necessary?",
    "options": [
      {
        "id": "q106_a",
        "text": "The host user must give permission"
      },
      {
        "id": "q106_b",
        "text": "The host user must initiate the RTR session"
      },
      {
        "id": "q106_c",
        "text": "Nothing else"
      },
      {
        "id": "q106_d",
        "text": "The analyst must have an assigned RTR role"
      }
    ],
    "correctOptionId": "q106_d",
    "explanation": ""
  },
  {
    "id": "q107",
    "prompt": "What is true about sensor install files?",
    "options": [
      {
        "id": "q107_a",
        "text": "Once a sensor is once, it never needs to be updated again."
      },
      {
        "id": "q107_b",
        "text": "The same sensor executable is used in all environments."
      },
      {
        "id": "q107_c",
        "text": "A new installer executable is made available for each new version"
      },
      {
        "id": "q107_d",
        "text": "New install files are made available every Tuesday."
      }
    ],
    "correctOptionId": "q107_c",
    "explanation": ""
  },
  {
    "id": "q108",
    "prompt": "A host with a Falcon sensor installed is called a(n)",
    "options": [
      {
        "id": "q108_a",
        "text": "Protected host"
      },
      {
        "id": "q108_b",
        "text": "Endpoint"
      },
      {
        "id": "q108_c",
        "text": "Managed host"
      },
      {
        "id": "q108_d",
        "text": "Falcon host"
      }
    ],
    "correctOptionId": "q108_c",
    "explanation": ""
  },
  {
    "id": "q109",
    "prompt": "Which of the following resembles a CID?",
    "options": [
      {
        "id": "q109_a",
        "text": "6C-6A-77-A3-F5-F7"
      },
      {
        "id": "q109_b",
        "text": "132592823447682795"
      },
      {
        "id": "q109_c",
        "text": "2474ad68b98e44Ic9daaf20a1d8f5d84"
      },
      {
        "id": "q109_d",
        "text": "23.229.209.5"
      }
    ],
    "correctOptionId": "q109_c",
    "explanation": ""
  },
  {
    "id": "q110",
    "prompt": "A sensor has not contacted the Falcon cloud for 45 days- What, if any, action takes at that time?",
    "options": [
      {
        "id": "q110_a",
        "text": "The sensor is deleted from the hosts list"
      },
      {
        "id": "q110_b",
        "text": "The sensor is upgraded to the most recent version"
      },
      {
        "id": "q110_c",
        "text": "Al events from the sensor say Inactive in the ComputerName field"
      },
      {
        "id": "q110_d",
        "text": "The sensor uninstalls itself"
      }
    ],
    "correctOptionId": "q110_a",
    "explanation": ""
  },
  {
    "id": "q111",
    "prompt": "Which Real-Tme Response (RTR) role is automatically asslgned to the Falcon Administrator?",
    "options": [
      {
        "id": "q111_a",
        "text": "No RTR roles are automatically assigned to the Falcon Administrator"
      },
      {
        "id": "q111_b",
        "text": "Active Responder"
      },
      {
        "id": "q111_c",
        "text": "Read Only Analyst"
      },
      {
        "id": "q111_d",
        "text": "Administrator"
      }
    ],
    "correctOptionId": "q111_a",
    "explanation": ""
  },
  {
    "id": "q112",
    "prompt": "Which of the following is NOT a method to configure sensor grouping tags on a Windows host?",
    "options": [
      {
        "id": "q112_a",
        "text": "Using the ACTIONS options when managing host in the console"
      },
      {
        "id": "q112_b",
        "text": "Using the GROUPING_TAGS parameter during installation"
      },
      {
        "id": "q112_c",
        "text": "Editing the registry after sensor installation"
      },
      {
        "id": "q112_d",
        "text": "Editing the registry via an RTR session"
      }
    ],
    "correctOptionId": "q112_a",
    "explanation": ""
  },
  {
    "id": "q113",
    "prompt": "What type of group automatically assigns hosts to the group when their hostname begins with ENG?",
    "options": [
      {
        "id": "q113_a",
        "text": "Hosts cannot be automatically asslgned to groups"
      },
      {
        "id": "q113_b",
        "text": "This type of asgnment is not allowed"
      },
      {
        "id": "q113_c",
        "text": "Dynamic"
      },
      {
        "id": "q113_d",
        "text": "Static"
      }
    ],
    "correctOptionId": "q113_c",
    "explanation": ""
  },
  {
    "id": "q114",
    "prompt": "What happens when a sensor build is in a custom sensor update policy?",
    "options": [
      {
        "id": "q114_a",
        "text": "All assigned hosts Will be upgraded or downgraded to the build selected"
      },
      {
        "id": "q114_b",
        "text": "All assigned hosts with a lower build Will be upgraded to the build selected"
      },
      {
        "id": "q114_c",
        "text": "All hosts with a higher build Will be dovmgraded to the build selected"
      },
      {
        "id": "q114_d",
        "text": "All hosts Will be upgraded or downgraded to the build selected"
      }
    ],
    "correctOptionId": "q114_a",
    "explanation": ""
  },
  {
    "id": "q115",
    "prompt": "Which exclusion pattern will prevent detections on all files only from the C:\\Users\\Developer\\\\Code\\ folder and all its subfolders on a Windows host?",
    "options": [
      {
        "id": "q115_a",
        "text": "\\Users\\Developer\\"
      },
      {
        "id": "q115_b",
        "text": "\\Users\\Developer\\Code\\*"
      },
      {
        "id": "q115_c",
        "text": "\\Users\\Developer\\Code\\**"
      },
      {
        "id": "q115_d",
        "text": "Users\\Developer\\Code\\**"
      }
    ],
    "correctOptionId": "q115_d",
    "explanation": ""
  },
  {
    "id": "q116",
    "prompt": "What syntax is used to configure Machine Learning exclusions?",
    "options": [
      {
        "id": "q116_a",
        "text": "Scala patterns"
      },
      {
        "id": "q116_b",
        "text": "Regex patterns"
      },
      {
        "id": "q116_c",
        "text": "Glob patterns"
      },
      {
        "id": "q116_d",
        "text": "Splunk patterns"
      }
    ],
    "correctOptionId": "q116_c",
    "explanation": ""
  },
  {
    "id": "q117",
    "prompt": "Which report will help you find sensors in RFM?",
    "options": [
      {
        "id": "q117_a",
        "text": "Sensor Health"
      },
      {
        "id": "q117_b",
        "text": "Inactive Sensors"
      },
      {
        "id": "q117_c",
        "text": "Sensor Coverage lookup"
      },
      {
        "id": "q117_d",
        "text": "Sensor Visibility Exclusions Audit"
      }
    ],
    "correctOptionId": "q117_a",
    "explanation": ""
  },
  {
    "id": "q118",
    "prompt": "What does an analyst use a Custom Alert for?",
    "options": [
      {
        "id": "q118_a",
        "text": "To receive an alert in an email"
      },
      {
        "id": "q118_b",
        "text": "Configure a new, unique alert for your environment"
      },
      {
        "id": "q118_c",
        "text": "Detect changes in \"Customs\" such as how analysts pivot during detections"
      },
      {
        "id": "q118_d",
        "text": "Edit the wording in detections"
      }
    ],
    "correctOptionId": "q118_a",
    "explanation": ""
  },
  {
    "id": "q119",
    "prompt": "When creating a new USB Device Policy, what MODE options are available?",
    "options": [
      {
        "id": "q119_a",
        "text": "Detect and enforce; Detect only"
      },
      {
        "id": "q119_b",
        "text": "Disable and enforce; Disable only"
      },
      {
        "id": "q119_c",
        "text": "Prevent and enforce; Prevent only"
      },
      {
        "id": "q119_d",
        "text": "Monitor and enforce; Monitor only"
      }
    ],
    "correctOptionId": "q119_d",
    "explanation": ""
  },
  {
    "id": "q120",
    "prompt": "What command should be run to verify if a Linux sensor is running?",
    "options": [
      {
        "id": "q120_a",
        "text": "ps -ef I grep falcon"
      },
      {
        "id": "q120_b",
        "text": "netstat -f"
      },
      {
        "id": "q120_c",
        "text": "regedit myfile.reg"
      },
      {
        "id": "q120_d",
        "text": "sc query csagent"
      }
    ],
    "correctOptionId": "q120_a",
    "explanation": ""
  },
  {
    "id": "q121",
    "prompt": "Which of the following is NOT a conditlon for successful Network Containment?",
    "options": [
      {
        "id": "q121_a",
        "text": "You must establish an Real Time Response session first"
      },
      {
        "id": "q121_b",
        "text": "The host machine must receive network traffic to/from the Falcon Cloud"
      },
      {
        "id": "q121_c",
        "text": "Any host with a sensor installed"
      },
      {
        "id": "q121_d",
        "text": "Users with the Falcon Security Lead or Falcon Administrator role"
      }
    ],
    "correctOptionId": "q121_a",
    "explanation": ""
  },
  {
    "id": "q122",
    "prompt": "When installing the sensor, what should you ensure for it to complete the provisioning process?",
    "options": [
      {
        "id": "q122_a",
        "text": "The host can communicate with the Falcon Cloud regardless of the OS platform"
      },
      {
        "id": "q122_b",
        "text": "The same sensor installer package is used on all OS platforms"
      },
      {
        "id": "q122_c",
        "text": "Sensors should be installed on all hosts at the same time"
      },
      {
        "id": "q122_d",
        "text": "The host is rebooted immediately after the provisioning phase is complete"
      }
    ],
    "correctOptionId": "q122_a",
    "explanation": ""
  },
  {
    "id": "q123",
    "prompt": "What is true about IOA Rule types on Linux?",
    "options": [
      {
        "id": "q123_a",
        "text": "Available IOA Rule types: Process Creation, File Creation, Network Connection, Domain Name"
      },
      {
        "id": "q123_b",
        "text": "Available IOA Rule types:Process Creation, File Creation"
      },
      {
        "id": "q123_c",
        "text": "Available IOA Rule types: Process Creation, File Creation, Domain Name"
      },
      {
        "id": "q123_d",
        "text": "Available IOA Rule types: Process Creation"
      }
    ],
    "correctOptionId": "q123_b",
    "explanation": ""
  },
  {
    "id": "q124",
    "prompt": "What is true about IOA Rule types on Windows?",
    "options": [
      {
        "id": "q124_a",
        "text": "Available IOA Rule types: Process Creation, File Creation, Network Connection, Domain Name"
      },
      {
        "id": "q124_b",
        "text": "Available IOA Rule types: Process Creation, File Creation, Network Connection"
      },
      {
        "id": "q124_c",
        "text": "Available IOA Rule types: Process Creation, File Creation"
      },
      {
        "id": "q124_d",
        "text": "Available IOA Rule types: File Creation"
      }
    ],
    "correctOptionId": "q124_a",
    "explanation": ""
  },
  {
    "id": "q125",
    "prompt": "What is true about IOA Rule types on macOS?",
    "options": [
      {
        "id": "q125_a",
        "text": "Available IOA Rule types: Process Creation, File Creation, Network Connection"
      },
      {
        "id": "q125_b",
        "text": "Available IOA Rule types: File Creation, Network Connection, Domain Name"
      },
      {
        "id": "q125_c",
        "text": "Available IOA Rule types: Network Connection, File Creation"
      },
      {
        "id": "q125_d",
        "text": "Available IOA Rule types: Domain Name"
      }
    ],
    "correctOptionId": "q125_a",
    "explanation": ""
  },
  {
    "id": "q126",
    "prompt": "Choose the correct option refering to API authentication process:",
    "options": [
      {
        "id": "q126_a",
        "text": "POST Request to /oauth2/token, returns 30 min token, API request with access token, API reponse"
      },
      {
        "id": "q126_b",
        "text": "GET Request to /oauth2/token, returns 30 min token, API request with access token, API reponse"
      },
      {
        "id": "q126_c",
        "text": "POST Request to /oauth3/token, returns 15 min token, API request with access token, API reponse"
      },
      {
        "id": "q126_d",
        "text": "POST Request to /oauth2/token, returns 10 min token, API request with access token, API reponse"
      }
    ],
    "correctOptionId": "q126_a",
    "explanation": ""
  },
  {
    "id": "q127",
    "prompt": "Who can create exclusions?",
    "options": [
      {
        "id": "q127_a",
        "text": "Falcon administrator"
      },
      {
        "id": "q127_b",
        "text": "Falcon administrator and Detections Exceptions Manager"
      },
      {
        "id": "q127_c",
        "text": "Falcon administrator, Detections Exceptions Manager, Security Lead, Endpoint Manager"
      },
      {
        "id": "q127_d",
        "text": "Security Lead, Endpoint Manager, Analyst"
      }
    ],
    "correctOptionId": "q127_b",
    "explanation": ""
  },
  {
    "id": "q128",
    "prompt": "What kind of filters are available for dynamic groups?",
    "options": [
      {
        "id": "q128_a",
        "text": "Standard attributes"
      },
      {
        "id": "q128_b",
        "text": "Standard attributes and Grouping tags"
      },
      {
        "id": "q128_c",
        "text": "Standard attributes and Falcon grouping tags"
      },
      {
        "id": "q128_d",
        "text": "Standard attributes and Sensor grouping tags"
      }
    ],
    "correctOptionId": "q128_b",
    "explanation": ""
  },
  {
    "id": "q129",
    "prompt": "Falcon grouping tags are characterized by:",
    "options": [
      {
        "id": "q129_a",
        "text": "Being managed with CLI and MDM and being deleted at 45 days of host inactivity"
      },
      {
        "id": "q129_b",
        "text": "Being managed with CLI and MDM and being deleted at 30 days of host inactivity"
      },
      {
        "id": "q129_c",
        "text": "Being managed with CLI nonmobile and MDM and being present as long as there is a host with one tag"
      },
      {
        "id": "q129_d",
        "text": "Being managed with CLI nonmobile and MDM and being present as long as there is at least 2 hosts with the same tag"
      }
    ],
    "correctOptionId": "q129_a",
    "explanation": ""
  },
  {
    "id": "q130",
    "prompt": "Sensor grouping tags are characterized by",
    "options": [
      {
        "id": "q130_a",
        "text": "Being managed with CLI and MDM and being deleted at 45 days of host inactivity"
      },
      {
        "id": "q130_b",
        "text": "Being managed with CLI and MDM and being deleted at 30 days of host inactivity"
      },
      {
        "id": "q130_c",
        "text": "Being managed with CLI nonmobile and MDM and being present as long as there is a host with one tag"
      },
      {
        "id": "q130_d",
        "text": "Being managed with CLI nonmobile and MDM and being present as long as there is at least 2 hosts with the same tag"
      }
    ],
    "correctOptionId": "q130_c",
    "explanation": ""
  },
  {
    "id": "q131",
    "prompt": "Its not recommended that a host group contain more than:",
    "options": [
      {
        "id": "q131_a",
        "text": "10000 hosts"
      },
      {
        "id": "q131_b",
        "text": "15000 hosts"
      },
      {
        "id": "q131_c",
        "text": "100000 hosts"
      },
      {
        "id": "q131_d",
        "text": "150000 hosts"
      }
    ],
    "correctOptionId": "q131_a",
    "explanation": ""
  },
  {
    "id": "q132",
    "prompt": "How many hosts can you add at the same time in a static group:",
    "options": [
      {
        "id": "q132_a",
        "text": "100"
      },
      {
        "id": "q132_b",
        "text": "1000"
      },
      {
        "id": "q132_c",
        "text": "10000"
      },
      {
        "id": "q132_d",
        "text": "100000"
      }
    ],
    "correctOptionId": "q132_b",
    "explanation": ""
  },
  {
    "id": "q133",
    "prompt": "What kind of data can be excluded using IOC?",
    "options": [
      {
        "id": "q133_a",
        "text": "Hash, Domains, IP addresses, Metadata"
      },
      {
        "id": "q133_b",
        "text": "Hash, Domains, IP addresses"
      },
      {
        "id": "q133_c",
        "text": "Hash, IP addresses, Metadata"
      },
      {
        "id": "q133_d",
        "text": "Hash, Metadata"
      }
    ],
    "correctOptionId": "q133_a",
    "explanation": ""
  },
  {
    "id": "q134",
    "prompt": "What flag is requiered in case there is an installation token (MacOS):",
    "options": [
      {
        "id": "q134_a",
        "text": "\"provisioning-token=\""
      },
      {
        "id": "q134_b",
        "text": "\"provisioning-token\""
      },
      {
        "id": "q134_c",
        "text": "\"ProvToken=\""
      },
      {
        "id": "q134_d",
        "text": "\"Prov_Token=\""
      }
    ],
    "correctOptionId": "q134_b",
    "explanation": ""
  },
  {
    "id": "q135",
    "prompt": "What flag is requiered in case there is an installation token (Windows):",
    "options": [
      {
        "id": "q135_a",
        "text": "\"provisioning-token=\""
      },
      {
        "id": "q135_b",
        "text": "\"provisioning-token\""
      },
      {
        "id": "q135_c",
        "text": "\"ProvToken=\""
      },
      {
        "id": "q135_d",
        "text": "\"Prov_Token=\""
      }
    ],
    "correctOptionId": "q135_c",
    "explanation": ""
  },
  {
    "id": "q136",
    "prompt": "What flag is requiered in case there is an installation token (Linux):",
    "options": [
      {
        "id": "q136_a",
        "text": "\"provisioning-token=\""
      },
      {
        "id": "q136_b",
        "text": "\"provisioning-token\""
      },
      {
        "id": "q136_c",
        "text": "\"ProvToken=\""
      },
      {
        "id": "q136_d",
        "text": "\"Prov_Token=\""
      }
    ],
    "correctOptionId": "q136_a",
    "explanation": ""
  },
  {
    "id": "q137",
    "prompt": "How can you enable Indentity Protection Traffic Inspection?",
    "options": [
      {
        "id": "q137_a",
        "text": "Indentity Protection > Configure > Identity configuration policies"
      },
      {
        "id": "q137_b",
        "text": "Host Setup and Management > Update Policies"
      },
      {
        "id": "q137_c",
        "text": "Endpoint Security > Prevention Policies"
      },
      {
        "id": "q137_d",
        "text": "You have to enable it from the host using \"traffic=1\""
      }
    ],
    "correctOptionId": "q137_a",
    "explanation": ""
  },
  {
    "id": "q138",
    "prompt": "How often are updates recommended?",
    "options": [
      {
        "id": "q138_a",
        "text": "30 days"
      },
      {
        "id": "q138_b",
        "text": "60 days"
      },
      {
        "id": "q138_c",
        "text": "30 or 60 days at least"
      },
      {
        "id": "q138_d",
        "text": "Each week"
      }
    ],
    "correctOptionId": "q138_c",
    "explanation": ""
  },
  {
    "id": "q139",
    "prompt": "An analys updated a group of hosts and he would like to revert to a previous version:",
    "options": [
      {
        "id": "q139_a",
        "text": "Revert to a previous version is not possible"
      },
      {
        "id": "q139_b",
        "text": "Its possible to revert to a previous version within the last 30 days"
      },
      {
        "id": "q139_c",
        "text": "Its possible to revert to a previous version within the last 90 days"
      },
      {
        "id": "q139_d",
        "text": "Its possible to revert to a previous version within the last 180 days"
      }
    ],
    "correctOptionId": "q139_d",
    "explanation": ""
  },
  {
    "id": "q140",
    "prompt": "What is not a option for Custom IOA Rule?",
    "options": [
      {
        "id": "q140_a",
        "text": "Process creation"
      },
      {
        "id": "q140_b",
        "text": "Network Connection"
      },
      {
        "id": "q140_c",
        "text": "File Creation"
      },
      {
        "id": "q140_d",
        "text": "USB Device connected"
      }
    ],
    "correctOptionId": "q140_d",
    "explanation": ""
  },
  {
    "id": "q141",
    "prompt": "What is not a template for Custom Alerts?",
    "options": [
      {
        "id": "q141_a",
        "text": "RTR sesión initiated"
      },
      {
        "id": "q141_b",
        "text": "Multiple failed analyst logons"
      },
      {
        "id": "q141_c",
        "text": "Host contained by analyst"
      },
      {
        "id": "q141_d",
        "text": "Automated Sensor update realized"
      }
    ],
    "correctOptionId": "q141_d",
    "explanation": ""
  },
  {
    "id": "q142",
    "prompt": "Control device settings are controlled through _______?",
    "options": [
      {
        "id": "q142_a",
        "text": "Rules"
      },
      {
        "id": "q142_b",
        "text": "Permission"
      },
      {
        "id": "q142_c",
        "text": "Policies"
      },
      {
        "id": "q142_d",
        "text": "Profiles"
      }
    ],
    "correctOptionId": "q142_c",
    "explanation": ""
  },
  {
    "id": "q143",
    "prompt": "What parameter is important when iyou install sensor on Windows with proxy?",
    "options": [
      {
        "id": "q143_a",
        "text": "ProvNoWait=1"
      },
      {
        "id": "q143_b",
        "text": "ProvWait=1"
      },
      {
        "id": "q143_c",
        "text": "ProvToken=1"
      },
      {
        "id": "q143_d",
        "text": "ProvNoToken=1"
      }
    ],
    "correctOptionId": "q143_a",
    "explanation": ""
  },
  {
    "id": "q144",
    "prompt": "How do you create IOA Rule for blocking Access to www.blandeo.com",
    "options": [
      {
        "id": "q144_a",
        "text": ".* blandeo.com.*"
      },
      {
        "id": "q144_b",
        "text": "blandeo.com.*"
      },
      {
        "id": "q144_c",
        "text": "*blandeo.com*"
      },
      {
        "id": "q144_d",
        "text": "blandeo.com"
      }
    ],
    "correctOptionId": "q144_a",
    "explanation": ""
  },
  {
    "id": "q145",
    "prompt": "Which RTR Policy permission does not exist?",
    "options": [
      {
        "id": "q145_a",
        "text": "Encrypt"
      },
      {
        "id": "q145_b",
        "text": "memdump"
      },
      {
        "id": "q145_c",
        "text": "xmemdump"
      },
      {
        "id": "q145_d",
        "text": "run"
      }
    ],
    "correctOptionId": "q145_a",
    "explanation": ""
  },
  {
    "id": "q146",
    "prompt": "What option does not exist for ML Antivirus settings?",
    "options": [
      {
        "id": "q146_a",
        "text": "Minimal"
      },
      {
        "id": "q146_b",
        "text": "Disabled"
      },
      {
        "id": "q146_c",
        "text": "Caoutious"
      },
      {
        "id": "q146_d",
        "text": "Extra-aggresive"
      }
    ],
    "correctOptionId": "q146_a",
    "explanation": ""
  },
  {
    "id": "q147",
    "prompt": "Which update policies are recommended?",
    "options": [
      {
        "id": "q147_a",
        "text": "Test-QA Group, Tech Pilot group, Critical Group"
      },
      {
        "id": "q147_b",
        "text": "Test-QA Group, Bussiness Pilot Group, Tech Pilot group, Critical Group"
      },
      {
        "id": "q147_c",
        "text": "Test-QA Group, Tech Pilot group and one group for each department"
      },
      {
        "id": "q147_d",
        "text": "Test-QA Group, Tech Pilot group, Business Pilot Group"
      }
    ],
    "correctOptionId": "q147_d",
    "explanation": ""
  },
  {
    "id": "q148",
    "prompt": "What is true about update policies?",
    "options": [
      {
        "id": "q148_a",
        "text": "No restart is required while updates"
      },
      {
        "id": "q148_b",
        "text": "Update policies are equal for all OS"
      },
      {
        "id": "q148_c",
        "text": "Updates cannot be cloud managed"
      },
      {
        "id": "q148_d",
        "text": "Update policies can be assigned without using a host group"
      }
    ],
    "correctOptionId": "q148_a",
    "explanation": ""
  },
  {
    "id": "q149",
    "prompt": "How may tags can be added per CID?",
    "options": [
      {
        "id": "q149_a",
        "text": "30"
      },
      {
        "id": "q149_b",
        "text": "50"
      },
      {
        "id": "q149_c",
        "text": "100"
      },
      {
        "id": "q149_d",
        "text": "1000"
      }
    ],
    "correctOptionId": "q149_d",
    "explanation": ""
  },
  {
    "id": "q150",
    "prompt": "How many tags can be added per host?",
    "options": [
      {
        "id": "q150_a",
        "text": "30"
      },
      {
        "id": "q150_b",
        "text": "50"
      },
      {
        "id": "q150_c",
        "text": "100"
      },
      {
        "id": "q150_d",
        "text": "1000"
      }
    ],
    "correctOptionId": "q150_b",
    "explanation": ""
  },
  {
    "id": "q151",
    "prompt": "What happen if there is a quarantined file of 64MB for 92 days?",
    "options": [
      {
        "id": "q151_a",
        "text": "A file above 32MB cant be quarantined"
      },
      {
        "id": "q151_b",
        "text": "It will be deleted from the host (30 days) and from the cloud (90 days)"
      },
      {
        "id": "q151_c",
        "text": "It will be deleted from the host (60 days) but not from the cloud (120 days)"
      },
      {
        "id": "q151_d",
        "text": "It will not be deleted from the host but from the cloud (60 days)"
      }
    ],
    "correctOptionId": "q151_a",
    "explanation": ""
  },
  {
    "id": "q152",
    "prompt": "What happen with quarantine files if a prevention policy is disabled?",
    "options": [
      {
        "id": "q152_a",
        "text": "No more files quarentined and former files remain quarentined"
      },
      {
        "id": "q152_b",
        "text": "Quarantining process will continue for 30 days and former files remain quarentined"
      },
      {
        "id": "q152_c",
        "text": "Quarantining process will continue and former files remain quarentined"
      },
      {
        "id": "q152_d",
        "text": "No more files quarentined and former files will be released"
      }
    ],
    "correctOptionId": "q152_a",
    "explanation": ""
  },
  {
    "id": "q153",
    "prompt": "What happen if there is a quarantined file of 16MB for 92 days?",
    "options": [
      {
        "id": "q153_a",
        "text": "A file above 12MB cant be quarantined"
      },
      {
        "id": "q153_b",
        "text": "It will be deleted from the host (30 days) and from the cloud (90 days)"
      },
      {
        "id": "q153_c",
        "text": "It will be deleted from the host (60 days) but not from the cloud (120 days)"
      },
      {
        "id": "q153_d",
        "text": "It will not be deleted from the host but from the cloud (60 days)"
      }
    ],
    "correctOptionId": "q153_b",
    "explanation": ""
  },
  {
    "id": "q154",
    "prompt": "Will files be quarantained in a host which is under network containment?",
    "options": [
      {
        "id": "q154_a",
        "text": "No, quarantine process will stop"
      },
      {
        "id": "q154_b",
        "text": "Yes, it continues to quarantine files normally"
      },
      {
        "id": "q154_c",
        "text": "Yes, it continues to quarantining files for 30 days"
      },
      {
        "id": "q154_d",
        "text": "No, quarantine process will stop and quarantine files will be released"
      }
    ],
    "correctOptionId": "q154_b",
    "explanation": ""
  },
  {
    "id": "q155",
    "prompt": "Choose the correct answer. Quarantining include:",
    "options": [
      {
        "id": "q155_a",
        "text": "Exploit mitigation"
      },
      {
        "id": "q155_b",
        "text": "Ransomware"
      },
      {
        "id": "q155_c",
        "text": "Exploit Behavior and Lateral movement and Credential Access"
      },
      {
        "id": "q155_d",
        "text": "None is correct"
      }
    ],
    "correctOptionId": "q155_d",
    "explanation": ""
  }
];
function shuffle(arr){
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

let QUESTIONS = [];
let idx = 0;
let score = 0;
let answered = 0;
let STATE = {};
// ---- Progress persistence (localStorage) ----
const PROGRESS_KEY = 'ccfa_200_test_progress_v1';

function setSaveStatus(msg){
  const el = document.getElementById('saveStatus');
  if (el) el.textContent = msg || "";
}

function getOptionSignature(opt){
  return (opt && (opt.text ?? opt.label ?? opt.choice ?? opt.value)) ?? JSON.stringify(opt);
}

function snapshotProgress(){
  const order = QUESTIONS.map(q => q.id);
  const optionOrders = {};
  for (const q of QUESTIONS){
    optionOrders[q.id] = (q.options || []).map(getOptionSignature);
  }
  return { v:3, savedAt:new Date().toISOString(), idx, score, answered, STATE, order, optionOrders };
}

function saveProgress(force=false){
  try{
    if (!force){
      const t = document.getElementById('autoSaveToggle');
      if (t && !t.checked) return false;
    }
    localStorage.setItem(PROGRESS_KEY, JSON.stringify(snapshotProgress()));
    setSaveStatus("Guardado ✔");
    return true;
  }catch(e){
    console.warn("saveProgress failed", e);
    setSaveStatus("No se pudo guardar");
    return false;
  }
}

function restoreFromSnapshot(snap){
  if (!snap || !Array.isArray(snap.order)) return false;
  const rawIndex = {};
  for (const rq of RAW_QUESTIONS) rawIndex[rq.id] = rq;

  const rebuilt = [];
  for (const qid of snap.order){
    const raw = rawIndex[qid];
    if (!raw) continue;
    const q = JSON.parse(JSON.stringify(raw));
    const savedOptOrder = (snap.optionOrders && snap.optionOrders[qid]) || null;
    if (savedOptOrder && Array.isArray(q.options)){
      const map = new Map();
      for (const opt of q.options) map.set(getOptionSignature(opt), opt);
      const newOpts = [];
      const used = new Set();
      for (const sig of savedOptOrder){
        const opt = map.get(sig);
        if (opt && !used.has(sig)){ newOpts.push(opt); used.add(sig); }
      }
      for (const opt of q.options){
        const sig = getOptionSignature(opt);
        if (!used.has(sig)) newOpts.push(opt);
      }
      q.options = newOpts;
    }
    rebuilt.push(q);
  }
  if (!rebuilt.length) return false;

  QUESTIONS = rebuilt;
  idx = Math.min(Math.max(0, Number(snap.idx)||0), QUESTIONS.length-1);
  score = Number(snap.score)||0;
  answered = Number(snap.answered)||0;
  STATE = snap.STATE || {};

  updateStats();
  render();
  setSaveStatus("Progreso cargado ✔");
  return true;
}

function loadProgress(forcePrompt=false){
  try{
    const raw = localStorage.getItem(PROGRESS_KEY);
    if (!raw){ setSaveStatus("No hay guardado"); return false; }
    const snap = JSON.parse(raw);
    if (forcePrompt){
      const ok = confirm("¿Cargar el progreso guardado? Esto reemplazará el estado actual.");
      if (!ok) return false;
    }
    return restoreFromSnapshot(snap);
  }catch(e){
    console.warn("loadProgress failed", e);
    setSaveStatus("No se pudo cargar");
    return false;
  }
}

function clearProgress(){
  try{ localStorage.removeItem(PROGRESS_KEY); setSaveStatus("Borrado ✔"); }
  catch(e){ console.warn("clearProgress failed", e); setSaveStatus("No se pudo borrar"); }
}

window.addEventListener('beforeunload', () => saveProgress(false));


function initQuiz(){
  QUESTIONS = JSON.parse(JSON.stringify(RAW_QUESTIONS));
  shuffle(QUESTIONS);
  QUESTIONS.forEach(q => shuffle(q.options));
  STATE = {};
  QUESTIONS.forEach(q => STATE[q.id] = { selected:null, graded:false, isCorrect:false });
  idx = 0; score = 0; answered = 0;
  document.getElementById("total").textContent = QUESTIONS.length;
  document.getElementById("total2").textContent = QUESTIONS.length;
  render();
  updateStats();

  // Offer to restore saved progress (if any) BEFORE writing a fresh snapshot
  try{
    const raw = localStorage.getItem(PROGRESS_KEY);
    if (raw){
      const ok = confirm("He encontrado un progreso guardado. ¿Quieres restaurarlo?");
      if (ok){
        const loaded = loadProgress(false);
        if (loaded) return; // stop: loadProgress already renders + updates stats
      }
    }
  }catch(e){}

  // Initial save in case user closes immediately (only if we didn't restore)
  saveProgress(false);
}

function updateStats(){
  document.getElementById("answered").textContent = answered;
  const scorePct = answered ? Math.round((score / answered) * 100) : 0;
  document.getElementById("score").textContent = `${scorePct}% (${score}/${answered})`;
  document.getElementById("currentIdx").textContent = (idx + 1);
  const pct = QUESTIONS.length ? Math.round((answered / QUESTIONS.length) * 100) : 0;
  document.getElementById("progressText").textContent = `Progress: ${pct}%`;
  document.getElementById("progressDetail").textContent = `${answered} answered • ${score} correct`;
  document.getElementById("barFill").style.width = `${pct}%`;
  document.getElementById("prevBtn").disabled = (idx === 0);
  document.getElementById("nextBtn").disabled = (idx === QUESTIONS.length - 1);
  const q = QUESTIONS[idx];
  const st = STATE[q.id];
  document.getElementById("submitBtn").disabled = st.graded;
}

function escapeHtml(str){
  return String(str)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

function render(){
  const q = QUESTIONS[idx];
  const st = STATE[q.id];
  const optsHtml = q.options.map((opt, i) => {
    const displayLetter = String.fromCharCode(65 + i);
    const checked = (st.selected === opt.id) ? "checked" : "";
    const disabled = (st.graded && !(typeof __mistakesMode !== "undefined" && __mistakesMode)) ? "disabled" : "";
    return `
      <label class="opt">
        <input type="radio" name="opt" value="${opt.id}" ${checked} ${disabled} />
        <div class="letter">${displayLetter}.</div>
        <div class="text">${escapeHtml(opt.text)}</div>
      </label>
    `;
  }).join("");

  document.getElementById("questionArea").innerHTML = `
    <p class="qNum">Question ${idx + 1} of ${QUESTIONS.length}</p>
    <div class="qTitle">${escapeHtml(q.prompt)}</div>
    <div class="options">${optsHtml}</div>
    <div class="feedback" id="feedbackBox"></div>
  `;

  document.querySelectorAll('input[name="opt"]').forEach(r => {
    r.addEventListener("change", () => { STATE[q.id].selected = r.value; });
  });

  if (st.graded) showFeedback(q, st);
  else hideFeedback();

  updateStats();
}

function submitAnswer(){
  const q = QUESTIONS[idx];
  const st = STATE[q.id];

  const wasGraded = !!st.graded;
  const prevCorrect = !!st.isCorrect;

  // In normal mode, prevent re-submitting already graded questions.
  // In mistakes practice mode, allow re-attempts on the same question.
  if (wasGraded && !(typeof __mistakesMode !== "undefined" && __mistakesMode)) return;

  if (!st.selected){
    const fb = document.getElementById("feedbackBox");
    fb.style.display = "block";
    fb.className = "feedback bad";
    fb.innerHTML = `<div class="row"><span class="badge bad">Select an answer</span><span class="muted">Choose one option, then submit.</span></div>`;
    return;
  }

  st.graded = true;
  st.isCorrect = (st.selected === q.correctOptionId);

  // Only count answered the first time a question gets graded.
  if (!wasGraded){
    answered += 1;
    if (st.isCorrect) score += 1;
  } else {
    // Re-grade (mistakes practice): adjust score if correctness changed.
    if (prevCorrect !== st.isCorrect){
      score += (st.isCorrect ? 1 : -1);
    }
  }

  // Disable radios only in normal mode; in mistakes practice allow changing answer and re-submitting.
  const lock = !(typeof __mistakesMode !== "undefined" && __mistakesMode);
  document.querySelectorAll('input[name="opt"]').forEach(r => r.disabled = lock);

  showFeedback(q, st);
  updateStats();

  // Refresh mistake loop so corrected questions disappear from "practice mistakes" navigation.
  if (typeof __mistakesMode !== "undefined" && __mistakesMode){
    try{ __refreshMistakeLoop(); }catch(e){}
    // If no mistakes left, auto-exit practice mode back to the test position.
    try{
      if (__mistakeIds && __mistakeIds.length === 0){
        const btn = document.getElementById("practiceMistakesBtn");
        __mistakesMode = false;
        if (btn) btn.textContent = "Repasar falladas";
        if (__returnQid) gotoQuestionId(__returnQid);
        __returnQid = null;
      }
    }catch(e){}
  }

  saveProgress(false);
}

function showFeedback(q, st){
  const fb = document.getElementById("feedbackBox");
  fb.style.display = "block";
  fb.className = st.isCorrect ? "feedback good" : "feedback bad";
  const status = st.isCorrect ? "Correct" : "Incorrect";
  const badgeClass = st.isCorrect ? "good" : "bad";
  const points = st.isCorrect ? "+1 point" : "0 points";
  const correctIndex = q.options.findIndex(o => o.id === q.correctOptionId);
  const correctLetter = correctIndex >= 0 ? String.fromCharCode(65 + correctIndex) : "?";
  fb.innerHTML = `
    <div class="row">
      <span class="badge ${badgeClass}">${status}</span>
      <span class="badge">${points}</span>
      <span class="muted">Correct answer: <b>${correctLetter}</b></span>
    </div>
    <div class="explain"><b>Explanation:</b> ${escapeHtml(q.explanation)}</div>
  `;
}

function hideFeedback(){
  const fb = document.getElementById("feedbackBox");
  if (!fb) return;
  fb.style.display = "none";
  fb.innerHTML = "";
}

function nextQ(){
  if (typeof __mistakesMode !== "undefined" && __mistakesMode){ if (__goMistake(1)) return; }
  if (idx < QUESTIONS.length - 1){ idx += 1; render(); }
  saveProgress(false);
}
function prevQ(){
  if (typeof __mistakesMode !== "undefined" && __mistakesMode){ if (__goMistake(-1)) return; }
  if (idx > 0){ idx -= 1; render(); }
  saveProgress(false);
}

function resetQuiz(){
  if (!confirm("Reset the quiz and reshuffle questions/answers? Your progress will be lost.")) return;
  initQuiz();

  saveProgress(false);
}

document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowRight") nextQ();
  if (e.key === "ArrowLeft") prevQ();
  if (e.key === "Enter") { e.preventDefault(); submitAnswer(); }
});

/* ===== Mistakes / Export / Practice Mode ===== */
let __mistakesMode = false;
let __mistakeIds = [];
let __mistakePos = 0;
let __returnQid = null; // remember where you were in normal test before practicing mistakes

function __getLetterForOption(q, optId){
  const i = (q.options||[]).findIndex(o => o.id === optId);
  return i >= 0 ? String.fromCharCode(65+i) : "?";
}
function __getOptionTextById(q, optId){
  const o = (q.options||[]).find(x => x.id === optId);
  return o ? (o.text || "") : "";
}
function __buildMistakes(){
  if (!Array.isArray(QUESTIONS)) return [];
  return QUESTIONS.filter(q => {
    const st = STATE && STATE[q.id];
    return st && st.graded && !st.isCorrect;
  });
}
function __downloadFile(filename, content, mime){
  try{
    const blob = new Blob([content], {type: mime});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url), 500);
  }catch(e){
    alert("No se pudo exportar: " + e);
  }
}
function __csvEscape(v){
  const s = (v===null || v===undefined) ? "" : String(v);
  const needs = /[",\n\r]/.test(s);
  const inner = s.replace(/"/g,'""');
  return needs ? `"${inner}"` : inner;
}
function __buildExportRows(mode){
  // mode: "mistakes" | "all"
  const rows = [];
  for (const q of QUESTIONS){
    const st = STATE[q.id];
    if (!st || !st.graded) continue;
    if (mode === "mistakes" && st.isCorrect) continue;

    const selLetter = st.selected ? __getLetterForOption(q, st.selected) : "";
    const selText = st.selected ? __getOptionTextById(q, st.selected) : "";
    const corLetter = __getLetterForOption(q, q.correctOptionId);
    const corText = __getOptionTextById(q, q.correctOptionId);

    // include ALL options (A/B/C/D/...)
    const options = [];
    if (Array.isArray(q.options)){
      for (let i=0;i<q.options.length;i++){
        const opt = q.options[i];
        const letter = String.fromCharCode(65+i);
        options.push({ letter, id: opt.id, text: opt.text || "" });
      }
    }

    rows.push({
      id: q.id,
      prompt: q.prompt || "",
      options,
      yourAnswerLetter: selLetter,
      yourAnswerText: selText,
      correctLetter: corLetter,
      correctText: corText,
      isCorrect: !!st.isCorrect,
      explanation: q.explanation || "",
      reference: q.reference || ""
    });
  }
  return rows;
}
function exportResultsJSON(mode){
  const rows = __buildExportRows(mode);
  const payload = {
    exportedAt: new Date().toISOString(),
    quiz: "CCFA",
    totalQuestions: QUESTIONS.length,
    answered: answered,
    score: score,
    mode,
    results: rows
  };
  __downloadFile(`ccfa_${mode}_export.json`, JSON.stringify(payload, null, 2), "application/json;charset=utf-8");
}
function exportResultsCSV(mode){
  const rows = __buildExportRows(mode);
  // Determine max options length for header (cap at 10 just in case)
  let maxOpt = 0;
  for (const r of rows){
    if (r.options && r.options.length > maxOpt) maxOpt = r.options.length;
  }
  maxOpt = Math.min(maxOpt, 10);
  const optHeaders = [];
  for (let i=0;i<maxOpt;i++){
    optHeaders.push(`option_${String.fromCharCode(65+i)}`);
  }

  const header = ["id","prompt", ...optHeaders, "yourAnswerLetter","yourAnswerText","correctLetter","correctText","isCorrect","explanation","reference"];
  const lines = [header.join(",")];

  for (const r of rows){
    const optCols = [];
    for (let i=0;i<maxOpt;i++){
      optCols.push((r.options && r.options[i]) ? (r.options[i].text || "") : "");
    }
    lines.push([
      r.id,
      r.prompt,
      ...optCols,
      r.yourAnswerLetter,
      r.yourAnswerText,
      r.correctLetter,
      r.correctText,
      r.isCorrect,
      r.explanation,
      r.reference
    ].map(__csvEscape).join(","));
  }

  __downloadFile(`ccfa_${mode}_export.csv`, lines.join("\n"), "text/csv;charset=utf-8");
}

function __renderOptionsReview(q, st){
  try{
    const sel = st ? st.selected : null;
    const correct = q.correctOptionId || q.correct || q.answer;
    let out = '<div class="opt-review">';
    for (const opt of (q.options || [])){
      const oid = opt.id ?? opt.value ?? opt.key ?? opt.letter;
      const letter = __getLetterForOption ? __getLetterForOption(q, oid) : (opt.letter || "");
      const txt = opt.text || opt.label || opt.valueText || opt.value || "";
      let cls = 'opt-item';
      if (oid === correct) cls += ' correct';
      if (sel && oid === sel){
        cls += (oid === correct) ? ' selected-correct' : ' selected-wrong';
      }
      out += `<div class="${cls}"><span class="opt-letter">${escapeHtml(letter)}.</span> <span class="opt-text">${escapeHtml(txt)}</span></div>`;
    }
    out += '</div>';
    return out;
  }catch(e){
    return '';
  }
}

function openMistakesModal(){
  const modal = document.getElementById("mistakesModal");
  const list = document.getElementById("mistakesList");
  const empty = document.getElementById("mistakesEmpty");
  if (!modal || !list || !empty) return;

  const mistakes = __buildMistakes();
  list.innerHTML = "";
  empty.style.display = mistakes.length ? "none" : "block";

  const subtitle = document.getElementById("mistakesSubtitle");
  if (subtitle){
    subtitle.textContent = mistakes.length
      ? `Tienes ${mistakes.length} preguntas falladas (se guarda con tu progreso).`
      : "No hay preguntas falladas todavía.";
  }

  for (const q of mistakes){
    const st = STATE[q.id];
    const yourLetter = st.selected ? __getLetterForOption(q, st.selected) : "?";
    const yourText = st.selected ? __getOptionTextById(q, st.selected) : "";
    const corLetter = __getLetterForOption(q, q.correctOptionId);
    const corText = __getOptionTextById(q, q.correctOptionId);

    const card = document.createElement("div");
    card.className = "mistake-card";
    card.innerHTML = `
      <div class="mistake-top">
        <div class="mistake-q">${escapeHtml(q.id)} • ${escapeHtml(q.prompt || q.question || "")}</div>
        <div class="mistake-meta">
          <span class="pill bad">Incorrecta</span>
          <span class="pill">Tu: <b>${escapeHtml(yourLetter)}</b></span>
          <span class="pill good">Correcta: <b>${escapeHtml(corLetter)}</b></span>
        </div>
      </div>

      <div class="mistake-box" style="margin-top:10px;">
        <div><b>Opciones</b></div>
        ${__renderOptionsReview(q, st)}
        <div class="tiny" style="opacity:.85; margin-top:8px;">
          <b>Tu respuesta:</b> ${escapeHtml(yourLetter)}. ${escapeHtml(yourText)}
          &nbsp;•&nbsp;
          <b>Correcta:</b> ${escapeHtml(corLetter)}. ${escapeHtml(corText)}
        </div>
      </div>

      <div class="mistake-box" style="margin-top:10px;">
        <div><b>Explicación</b></div>
        <div class="tiny">${escapeHtml(q.explanation || q.rationale || "")}</div>
      </div>
      ${q.reference ? `<div class="tiny" style="margin-top:8px; opacity:.8;"><b>Reference:</b> ${escapeHtml(q.reference)}</div>` : ``}
      <div class="mistake-actions">
        <button class="ghost" type="button" data-goto="${escapeHtml(q.id)}">Ir a esta pregunta</button>
      </div>
    `;
    card.querySelector('button[data-goto]').addEventListener('click', () => {
      closeMistakesModal();
      gotoQuestionId(q.id);
    });
    list.appendChild(card);
  }

  modal.style.display = "flex";
}
function closeMistakesModal(){
  const modal = document.getElementById("mistakesModal");
  if (modal) modal.style.display = "none";
}

function gotoQuestionId(qid){
  const i = QUESTIONS.findIndex(q => q.id === qid);
  if (i < 0) return;
  idx = i;
  render();
  const st = STATE[qid];
  if (st && st.graded){
    // show stored feedback (consistent)
    showFeedback(QUESTIONS[idx], st);
  }
  saveProgress(false);
}

function __refreshMistakeLoop(){
  const mistakes = __buildMistakes();
  __mistakeIds = mistakes.map(q => q.id);
  if (__mistakePos >= __mistakeIds.length) __mistakePos = 0;
  if (__mistakeIds.length === 0){
    __mistakesMode = false;
    const btn = document.getElementById("practiceMistakesBtn");
    if (btn) btn.textContent = "Repasar falladas";
  }
}

// Open a dedicated "practice mistakes" panel that behaves like a new test:
// - Only incorrect questions
// - Lets you answer again
// - Updates the real saved progress/state
let __mpReturnQid = null;
let __mpIds = [];
let __mpPos = 0;
const __mpStorageKey = (typeof STORAGE_KEY !== "undefined" ? STORAGE_KEY : "quiz") + "::mistakesPracticeSession";

function __mpSave(){
  try{
    const payload = {
      ids: __mpIds,
      pos: __mpPos,
      returnQid: __mpReturnQid,
      // store draft selection per qid so you can close and continue later
      draft: __mpDraft || {},
      cleared: Array.from(__mpCleared || [])
    };
    localStorage.setItem(__mpStorageKey, JSON.stringify(payload));
  }catch(e){}
}
function __mpLoad(){
  try{
    const raw = localStorage.getItem(__mpStorageKey);
    if (!raw) return null;
    return JSON.parse(raw);
  }catch(e){ return null; }
}
function __mpClear(){
  try{ localStorage.removeItem(__mpStorageKey); }catch(e){}
}

let __mpDraft = {}; // qid -> optionId (selected in panel but not submitted)

function openMistakesPracticePanel(){
  const mistakes = __buildMistakes(); // incorrect + graded
  const ids = mistakes.map(q => q.id);
  if (!ids.length){
    alert("No tienes falladas todavía.");
    return;
  }

  // Remember where you were in the normal test
  try{ __mpReturnQid = (QUESTIONS[idx] && QUESTIONS[idx].id) ? QUESTIONS[idx].id : null; }catch(e){ __mpReturnQid = null; }

  // Load prior session if it matches the current mistakes set (same ids in same order)
  const prev = __mpLoad();
  if (prev && Array.isArray(prev.ids) && prev.ids.length){
    const same = prev.ids.length === ids.length && prev.ids.every((v,i)=>v===ids[i]);
    if (same){
      __mpIds = prev.ids.slice();
      __mpPos = Math.min(Math.max(prev.pos||0,0), __mpIds.length-1);
      __mpDraft = (prev.draft && typeof prev.draft==="object") ? prev.draft : {};
      __mpCleared = new Set(Array.isArray(prev.cleared)?prev.cleared:[]);
    } else {
      __mpIds = ids.slice();
      __mpPos = 0;
      __mpDraft = {};
      __mpCleared = new Set();
    }
  } else {
    __mpIds = ids.slice();
    __mpPos = 0;
    __mpDraft = {};
    __mpCleared = new Set();
  }

  // Open modal and render
  const modal = document.getElementById("mistakesPracticeModal");
  if (!modal) return;
  modal.style.display = "flex";
  mpRender();
  __mpSave();
}

function closeMistakesPracticePanel(){
  const modal = document.getElementById("mistakesPracticeModal");
  if (modal) modal.style.display = "none";
  // return to original question (where you were in the test)
  if (__mpReturnQid) gotoQuestionId(__mpReturnQid);
  __mpReturnQid = null;
  __mpSave();
  saveProgress(false);
}

function mpNav(delta){
  if (!__mpIds.length) return;
  __mpPos = (__mpPos + delta) % __mpIds.length;
  if (__mpPos < 0) __mpPos = __mpIds.length - 1;
  mpRender();
  __mpSave();
}

function mpRender(){
  const title = document.getElementById("mpTitle");
  const sub   = document.getElementById("mpSubtitle");
  const body  = document.getElementById("mpBody");
  const prog  = document.getElementById("mpProgress");
  const prevB = document.getElementById("mpPrevBtn");
  const nextB = document.getElementById("mpNextBtn");
  const submitB = document.getElementById("mpSubmitBtn");

  if (!body) return;

  // Recompute remaining mistakes live (because user can fix them in this panel)
  const liveIds = __buildMistakes().map(q => q.id);
  // Keep only ids that are still incorrect AND not already cleared in this panel
  __mpIds = __mpIds.filter(id => liveIds.includes(id) && !__mpCleared.has(id));
  if (!__mpIds.length){
    // Done
    body.innerHTML = `<div class="tiny" style="opacity:.9; padding:10px 0;"><b>✅ Perfecto.</b> Ya no te quedan preguntas falladas.</div>`;
    if (title) title.textContent = "Repasar falladas";
    if (sub) sub.textContent = "No quedan falladas. Puedes cerrar para volver al test.";
    if (prog) prog.textContent = "";
    if (prevB) prevB.disabled = true;
    if (nextB) nextB.disabled = true;
    if (submitB) submitB.disabled = true;
    __mpClear();
    return;
  }
  if (__mpPos >= __mpIds.length) __mpPos = 0;

  const qid = __mpIds[__mpPos];
  const q = QUESTIONS.find(x => x.id === qid);
  if (!q){
    body.innerHTML = `<div class="tiny">Error: no encuentro la pregunta ${escapeHtml(qid)}.</div>`;
    return;
  }

  // Panel header
  if (title) title.textContent = "Repasar falladas (rehacer)";
  if (sub) sub.textContent = `Vas a rehacer SOLO las falladas. Al corregir una, desaparece de aquí.`;
  if (prog) prog.textContent = `Falladas pendientes: ${__mpIds.length} • ${__mpPos+1}/${__mpIds.length}`;

  const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
  const draftSel = __mpDraft[qid] || "";

  // Render question + options
  let html = '';
  html += `<div class="mp-qid">${escapeHtml(q.id)}</div>`;
  html += `<div class="mp-prompt">${escapeHtml(q.prompt || q.question || "")}</div>`;
  html += `<div class="mp-opts">`;

  for (let i=0;i<(q.options||[]).length;i++){
    const opt = q.options[i];
    const letter = letters[i] || (i+1);
    const checked = (draftSel && draftSel === opt.id) ? 'checked' : '';
    html += `
      <label class="mp-opt">
        <input type="radio" name="mpOpt" value="${escapeHtml(opt.id)}" ${checked}>
        <span class="mp-opt-letter">${escapeHtml(letter)}.</span>
        <span class="mp-opt-text">${escapeHtml(opt.text || "")}</span>
      </label>
    `;
  }
  html += `</div>`;

  body.innerHTML = html;

  // Draft selection changes
  body.querySelectorAll('input[name="mpOpt"]').forEach(el => {
    el.addEventListener('change', () => {
      __mpDraft[qid] = el.value;
      __mpSave();
    });
  });

  if (prevB) prevB.disabled = (__mpIds.length <= 1);
  if (nextB) nextB.disabled = (__mpIds.length <= 1);
  if (submitB) submitB.disabled = false;
}

function __mpMarkAttempt(qid, optId){
  const q = QUESTIONS.find(x => x.id === qid);
  if (!q) return {isCorrect:false};
  // Evaluate correctness WITHOUT touching the main saved progress/score.
  const ok = (optId === q.correctOptionId);
  if (ok) __mpCleared.add(qid);
  else __mpCleared.delete(qid);
  return {isCorrect: ok};
}

function mpSubmit(){
  if (!__mpIds.length) return;
  const qid = __mpIds[__mpPos];
  const body = document.getElementById("mpBody");
  if (!body) return;

  const sel = body.querySelector('input[name="mpOpt"]:checked');
  if (!sel){
    alert("Selecciona una opción antes de enviar.");
    return;
  }
  const optId = sel.value;

  __mpMarkAttempt(qid, optId);

  // Clear draft for this question
  try{ delete __mpDraft[qid]; }catch(e){}

  // Persist ONLY the practice panel session (no impact on global stats)
  __mpSave();

  // Re-render (it will drop fixed questions via __mpCleared)
  mpRender();
}

// Keep old API calls from other parts safe
function toggleMistakesPractice(){ openMistakesPracticePanel(); }
function __goMistake(){ return false; }
function retryCurrentIfWrong(){ openMistakesPracticePanel(); }

function __goMistake(delta){
  if (!__mistakesMode) return false;
  __refreshMistakeLoop();
  if (__mistakeIds.length === 0) return true;

  __mistakePos = (__mistakePos + delta) % __mistakeIds.length;
  if (__mistakePos < 0) __mistakePos = __mistakeIds.length - 1;
  gotoQuestionId(__mistakeIds[__mistakePos]);
  return true;
}

function retryCurrentIfWrong(){
  const q = QUESTIONS[idx];
  const st = STATE[q.id];
  if (!st || !st.graded || st.isCorrect) return;
  // Undo grading for this question
  st.graded = false;
  st.isCorrect = false;
  st.selected = null;

  if (answered > 0) answered -= 1;
  // score unchanged because it was incorrect
  document.querySelectorAll('input[name="opt"]').forEach(r => { r.disabled = false; r.checked = false; });
  hideFeedback();
  updateStats();
  saveProgress(false);
}

// Wrap navigation + submit to keep mistakes mode in sync
(function hookMistakeMode(){
  try{
    const _nextQ = nextQ;
    const _prevQ = prevQ;
    window.nextQ = function(){ if (__goMistake(1)) return; _nextQ(); };
    window.prevQ = function(){ if (__goMistake(-1)) return; _prevQ(); };

    const _submitAnswer = submitAnswer;
    window.submitAnswer = function(){
      _submitAnswer();
      __refreshMistakeLoop();
    };

    // Add small "Reintentar" button in feedback when incorrect
    const _showFeedback = showFeedback;
    window.showFeedback = function(q, st){ _showFeedback(q, st); };
  }catch(e){}
})();

function setupMistakesUI(){
  const reviewBtn = document.getElementById("reviewMistakesBtn");
  const practiceBtn = document.getElementById("practiceMistakesBtn");
  const closeBtn = document.getElementById("closeMistakesModal");
  const modal = document.getElementById("mistakesModal");

  // Practice (panel)
  const pModal = document.getElementById("mistakesPracticeModal");
  const pClose = document.getElementById("closeMistakesPracticeModal");
  const pPrev  = document.getElementById("mpPrevBtn");
  const pNext  = document.getElementById("mpNextBtn");
  const pSubmit= document.getElementById("mpSubmitBtn");
  const pExit  = document.getElementById("mpExitBtn");
  const expAllJson = document.getElementById("exportAllJsonBtn");
  const expAllCsv  = document.getElementById("exportAllCsvBtn");

  if (reviewBtn) reviewBtn.addEventListener('click', openMistakesModal);
  if (practiceBtn) practiceBtn.addEventListener('click', openMistakesPracticePanel);
  if (closeBtn) closeBtn.addEventListener('click', closeMistakesModal);
  if (modal) modal.addEventListener('click', (e) => { if (e.target === modal) closeMistakesModal(); });

  if (pClose) pClose.addEventListener('click', closeMistakesPracticePanel);
  if (pExit)  pExit.addEventListener('click', closeMistakesPracticePanel);
  if (pModal) pModal.addEventListener('click', (e) => { if (e.target === pModal) closeMistakesPracticePanel(); });
  if (pPrev)  pPrev.addEventListener('click', () => mpNav(-1));
  if (pNext)  pNext.addEventListener('click', () => mpNav(1));
  if (pSubmit)pSubmit.addEventListener('click', mpSubmit);

  // Export buttons inside review modal
  const expMJ = document.getElementById("exportMistakesJsonBtn");
  const expMC = document.getElementById("exportMistakesCsvBtn");
  if (expMJ) expMJ.addEventListener('click', () => exportJson('mistakes'));
  if (expMC) expMC.addEventListener('click', () => exportCsv('mistakes'));

  if (expAllJson) expAllJson.addEventListener('click', () => exportJson('all'));
  if (expAllCsv)  expAllCsv.addEventListener('click', () => exportCsv('all'));

  // ESC closes practice modal
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape'){
      const pm = document.getElementById("mistakesPracticeModal");
      if (pm && pm.style.display !== "none") closeMistakesPracticePanel();
    }
  });
}
/* ===== End Mistakes / Export / Practice Mode ===== */

window.addEventListener('DOMContentLoaded', () => {
  setupMistakesUI();
  initQuiz();
// Validate question count (should not render on page)
(function(){
  try{
    const expected = 155;
    const el = document.getElementById('countWarn');
    if (el && Array.isArray(QUESTIONS) && QUESTIONS.length !== expected){
      el.style.display = 'block';
      el.textContent = `⚠️ Expected ${expected} questions, but loaded ${QUESTIONS.length}. Some questions are missing.`;
    }
  }catch(e){}
})();

});
</script>

<!-- Mistakes / Review Modal -->
<div id="mistakesModal" class="modal" style="display:none;">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="mistakesTitle">
    <div class="modal-head">
      <div>
        <div class="modal-title" id="mistakesTitle">Preguntas falladas</div>
        <div class="modal-sub" id="mistakesSubtitle">Aquí verás tus fallos (guardado con el progreso hasta que reinicies).</div>
      </div>
      <button class="ghost" type="button" id="closeMistakesModal">Cerrar</button>
    </div>

    <div class="modal-actions">
      <button class="ghost" type="button" id="exportMistakesJsonBtn">Exportar falladas (JSON)</button>
      <button class="ghost" type="button" id="exportMistakesCsvBtn">Exportar falladas (CSV)</button>
      <button class="ghost" type="button" id="exportAllJsonBtn">Exportar todo (JSON)</button>
      <button class="ghost" type="button" id="exportAllCsvBtn">Exportar todo (CSV)</button>
    </div>

    <div class="modal-body">
      <div id="mistakesEmpty" class="muted" style="display:none; padding:10px 0;">No hay preguntas falladas todavía.</div>
      <div id="mistakesList" class="mistakes-list"></div>
    </div>
  </div>
</div>

<!-- Mistakes Practice Modal -->
<div class="modal" id="mistakesPracticeModal" style="display:none;">
  <div class="modal-card">
    <div class="modal-head">
      <div>
        <div class="modal-title" id="mpTitle">Repasar falladas</div>
        <div class="modal-sub" id="mpSubtitle">Vuelve a responder SOLO las preguntas falladas.</div>
      </div>
      <button class="ghost" id="closeMistakesPracticeModal" type="button">Cerrar ✕</button>
    </div>

    <div class="modal-actions">
      <span class="pill" id="mpProgress"></span>
      <button class="ghost" type="button" id="mpPrevBtn">← Anterior</button>
      <button class="ghost" type="button" id="mpNextBtn">Siguiente →</button>
      <button class="primary" type="button" id="mpSubmitBtn">Enviar respuesta</button>
      <button class="ghost" type="button" id="mpExitBtn">Volver al test</button>
    </div>

    <div class="modal-body" id="mpBody"></div>
  </div>
</div>

<style>
  .mp-qid{opacity:.75; font-size:12px; margin-bottom:6px;}
  .mp-prompt{font-size:18px; font-weight:750; line-height:1.35; margin-bottom:12px;}
  .mp-opts{display:grid; gap:10px; margin-top:10px;}
  .mp-opt{display:flex; gap:10px; align-items:flex-start; padding:12px 12px; border-radius:14px;
    border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.03); cursor:pointer;}
  .mp-opt:hover{background:rgba(255,255,255,.05);}
  .mp-opt input{margin-top:3px;}
  .mp-opt-letter{font-weight:800; min-width:26px;}
  .mp-opt-text{opacity:.95;}
</style>

</body>
</html>


